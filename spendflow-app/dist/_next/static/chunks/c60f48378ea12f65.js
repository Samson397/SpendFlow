(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,29789,e=>{"use strict";var s=e.i(52621),t=e.i(2188),a=e.i(84614),r=e.i(63488),l=e.i(98919),i=e.i(87316),n=e.i(86311),d=e.i(92930),c=e.i(43531),o=e.i(37727),m=e.i(84099),x=e.i(65131),u=e.i(82078),h=e.i(43553),b=e.i(61659),p=e.i(78894),g=e.i(77529),j=e.i(73884),f=e.i(63209);e.i(75271);var v=e.i(5158),N=e.i(41195);class y{static instance;static getInstance(){return y.instance||(y.instance=new y),y.instance}async getCurrentMonthUsage(e){let s=new Date,t=new Date(s.getFullYear(),s.getMonth(),1),a=new Date(s.getFullYear(),s.getMonth()+1,0,23,59,59,999),[r,l,i]=await Promise.all([this.getCardsCreatedThisMonth(e,t,a),this.getTransactionsThisMonth(e,t,a),this.getReportsGeneratedThisMonth(e,t,a)]);return{cardsUsed:r,transactionsCount:l,reportsGenerated:i,monthStart:t,monthEnd:a}}async getCardsCreatedThisMonth(e,s,t){try{let a=(0,v.collection)(N.db,"cards"),r=(0,v.query)(a,(0,v.where)("userId","==",e),(0,v.where)("createdAt",">=",v.Timestamp.fromDate(s)),(0,v.where)("createdAt","<=",v.Timestamp.fromDate(t)));return(await (0,v.getDocs)(r)).size}catch(e){return console.error("Error counting cards created this month:",e),0}}async getTransactionsThisMonth(e,s,t){try{let a=(0,v.collection)(N.db,"transactions"),r=(0,v.query)(a,(0,v.where)("userId","==",e),(0,v.where)("date",">=",v.Timestamp.fromDate(s)),(0,v.where)("date","<=",v.Timestamp.fromDate(t)));return(await (0,v.getDocs)(r)).size}catch(e){return console.error("Error counting transactions this month:",e),0}}async getReportsGeneratedThisMonth(e,s,t){try{return 0}catch(e){return console.error("Error counting reports generated this month:",e),0}}async checkUsageLimits(e,s){let t=await this.getCurrentMonthUsage(e),a=-1!==s.maxCards&&t.cardsUsed>=.8*s.maxCards,r=-1!==s.maxTransactions&&t.transactionsCount>=.8*s.maxTransactions;return{cardsNearLimit:a,transactionsNearLimit:r,cardsAtLimit:-1!==s.maxCards&&t.cardsUsed>=s.maxCards,transactionsAtLimit:-1!==s.maxTransactions&&t.transactionsCount>=s.maxTransactions}}}let w=y.getInstance();function S(){let{tier:e,subscription:a,theme:r,cancelSubscription:l,reactivateSubscription:n,upgradeToTier:d}=(0,x.useSubscription)(),{user:c}=(0,t.useAuth)(),[o,m]=(0,u.useState)(!1),[v,N]=(0,u.useState)(null),[y,S]=(0,u.useState)(null),[k,C]=(0,u.useState)(!0);(0,u.useEffect)(()=>{(async()=>{if(c)try{C(!0);let[e,s]=await Promise.all([w.getCurrentMonthUsage(c.uid),w.checkUsageLimits(c.uid,{maxCards:r.maxCards,maxTransactions:r.maxTransactions})]);N(e),S(s)}catch(e){console.error("Error fetching usage data:",e)}finally{C(!1)}})()},[c,r.maxCards,r.maxTransactions]);let A=(e,s)=>s?"text-red-400":e?"text-amber-400":"text-green-400",T=(e,t)=>t?(0,s.jsx)(j.XCircle,{className:"h-4 w-4"}):e?(0,s.jsx)(p.AlertTriangle,{className:"h-4 w-4"}):(0,s.jsx)(g.CheckCircle,{className:"h-4 w-4"});return a?(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsxs)("div",{className:"bg-linear-to-br from-amber-900/20 via-slate-900/50 to-slate-900/20 border border-amber-700/30 rounded-lg p-6 sm:p-8",children:[(0,s.jsxs)("div",{className:"flex items-start justify-between mb-6",children:[(0,s.jsxs)("div",{children:[(0,s.jsxs)("div",{className:"flex items-center gap-3 mb-2",children:[(0,s.jsx)(h.Crown,{className:"h-6 w-6 text-amber-400"}),(0,s.jsxs)("h3",{className:"text-xl sm:text-2xl font-serif text-slate-100",children:[r.name," Plan"]})]}),(0,s.jsxs)("div",{className:`flex items-center gap-2 text-sm ${(e=>{switch(e){case"active":return"text-green-400";case"canceled":return"text-red-400";case"past_due":return"text-amber-400";default:return"text-slate-400"}})(a.status)}`,children:[(e=>{switch(e){case"active":return(0,s.jsx)(g.CheckCircle,{className:"h-4 w-4"});case"canceled":return(0,s.jsx)(j.XCircle,{className:"h-4 w-4"});default:return(0,s.jsx)(p.AlertTriangle,{className:"h-4 w-4"})}})(a.status),(0,s.jsx)("span",{className:"capitalize",children:a.status.replace("_"," ")})]})]}),"enterprise"!==e&&(0,s.jsx)("button",{onClick:()=>d("enterprise"),className:"px-4 py-2 bg-amber-600 hover:bg-amber-700 text-white text-sm font-medium rounded-md transition-colors",children:"Upgrade to Enterprise"})]}),(0,s.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4 mb-6",children:[(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[(0,s.jsx)(i.Calendar,{className:"h-5 w-5 text-amber-400"}),(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:"text-slate-400 text-sm",children:"Current Period"}),(0,s.jsx)("div",{className:"text-slate-200",children:a.currentPeriodEnd.toLocaleDateString()})]})]}),(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[(0,s.jsx)(b.CreditCard,{className:"h-5 w-5 text-amber-400"}),(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:"text-slate-400 text-sm",children:"Started"}),(0,s.jsx)("div",{className:"text-slate-200",children:a.startDate.toLocaleDateString()})]})]})]}),(0,s.jsxs)("div",{className:"mb-6",children:[(0,s.jsx)("h4",{className:"text-slate-300 font-semibold mb-3",children:"Your Plan Includes:"}),(0,s.jsx)("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-2",children:r.features.map((e,t)=>(0,s.jsxs)("div",{className:"flex items-center gap-2 text-sm text-slate-400",children:[(0,s.jsx)(g.CheckCircle,{className:"h-4 w-4 text-green-400 shrink-0"}),e]},t))})]}),"active"===a.status&&!a.cancelAtPeriodEnd&&"free"!==e&&(0,s.jsx)("div",{className:"flex flex-col sm:flex-row gap-3",children:(0,s.jsx)("button",{onClick:()=>m(!0),className:"px-4 py-2 border border-red-600 text-red-400 hover:bg-red-600/10 text-sm font-medium rounded-md transition-colors",children:"Cancel Subscription"})}),a.cancelAtPeriodEnd&&(0,s.jsx)("div",{className:"bg-red-900/20 border border-red-700/50 rounded-md p-4",children:(0,s.jsxs)("div",{className:"flex items-start gap-3",children:[(0,s.jsx)(p.AlertTriangle,{className:"h-5 w-5 text-red-400 shrink-0 mt-0.5"}),(0,s.jsxs)("div",{children:[(0,s.jsx)("h4",{className:"text-red-400 font-semibold mb-1",children:"Subscription Cancelled"}),(0,s.jsxs)("p",{className:"text-red-300 text-sm mb-3",children:["Your subscription will end on ",a.currentPeriodEnd.toLocaleDateString(),". You'll retain access until then."]}),(0,s.jsx)("button",{onClick:n,className:"px-4 py-2 bg-green-600 hover:bg-green-700 text-white text-sm font-medium rounded-md transition-colors",children:"Reactivate Subscription"})]})]})})]}),(0,s.jsxs)("div",{className:"bg-slate-900/50 border border-slate-800 backdrop-blur-sm p-6 rounded-lg",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,s.jsx)("h4",{className:"text-slate-300 font-semibold",children:"Usage This Month"}),y&&(y.cardsNearLimit||y.transactionsNearLimit)&&(0,s.jsxs)("div",{className:"flex items-center gap-2 text-amber-400 text-sm",children:[(0,s.jsx)(p.AlertTriangle,{className:"h-4 w-4"}),(0,s.jsx)("span",{children:"Near limit"})]})]}),k?(0,s.jsx)("div",{className:"flex items-center justify-center py-8",children:(0,s.jsx)("div",{className:"animate-spin rounded-full h-6 w-6 border-t-2 border-b-2 border-amber-500"})}):v?(0,s.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-4",children:[(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsxs)("div",{className:`text-2xl font-serif mb-1 flex items-center justify-center gap-2 ${y?A(y.cardsNearLimit,y.cardsAtLimit):"text-slate-100"}`,children:[y&&T(y.cardsNearLimit,y.cardsAtLimit),v.cardsUsed]}),(0,s.jsx)("div",{className:"text-slate-400 text-sm",children:"Cards Used"}),(0,s.jsx)("div",{className:"text-slate-500 text-xs",children:-1===r.maxCards?"Unlimited":`of ${r.maxCards}`})]}),(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsxs)("div",{className:`text-2xl font-serif mb-1 flex items-center justify-center gap-2 ${y?A(y.transactionsNearLimit,y.transactionsAtLimit):"text-slate-100"}`,children:[y&&T(y.transactionsNearLimit,y.transactionsAtLimit),v.transactionsCount]}),(0,s.jsx)("div",{className:"text-slate-400 text-sm",children:"Transactions"}),(0,s.jsx)("div",{className:"text-slate-500 text-xs",children:-1===r.maxTransactions?"Unlimited":`of ${r.maxTransactions}`})]}),(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)("div",{className:"text-2xl font-serif text-slate-100 mb-1",children:v.reportsGenerated}),(0,s.jsx)("div",{className:"text-slate-400 text-sm",children:"Reports Generated"}),(0,s.jsx)("div",{className:"text-slate-500 text-xs",children:r.analytics?"Analytics enabled":"Upgrade for analytics"})]})]}):(0,s.jsx)("div",{className:"text-center py-8",children:(0,s.jsx)("div",{className:"text-slate-400",children:"Unable to load usage data"})}),y&&(y.cardsAtLimit||y.transactionsAtLimit)&&(0,s.jsx)("div",{className:"mt-4 p-3 bg-red-900/20 border border-red-700/50 rounded-md",children:(0,s.jsxs)("div",{className:"flex items-center gap-2 text-red-400 text-sm",children:[(0,s.jsx)(f.AlertCircle,{className:"h-4 w-4"}),(0,s.jsx)("span",{children:"You've reached your plan limits. Consider upgrading for more usage."})]})})]}),o&&(0,s.jsx)("div",{className:"fixed inset-0 z-50 bg-black/80 backdrop-blur-sm flex items-center justify-center p-4",children:(0,s.jsxs)("div",{className:"bg-slate-950 border border-red-700/30 rounded-lg shadow-2xl max-w-md w-full p-6",children:[(0,s.jsxs)("div",{className:"text-center mb-6",children:[(0,s.jsx)("div",{className:"w-16 h-16 bg-red-900/20 rounded-full flex items-center justify-center mx-auto mb-4",children:(0,s.jsx)(p.AlertTriangle,{className:"h-8 w-8 text-red-400"})}),(0,s.jsx)("h3",{className:"text-xl font-serif text-slate-100 mb-2",children:"Cancel Subscription?"}),(0,s.jsxs)("p",{className:"text-slate-400 text-sm",children:["You'll lose access to ",r.name," features at the end of your current billing period. You can reactivate anytime before then."]})]}),(0,s.jsxs)("div",{className:"space-y-3",children:[(0,s.jsx)("button",{onClick:()=>{l(),m(!1)},className:"w-full px-6 py-3 bg-red-600 hover:bg-red-700 text-white font-medium rounded-md transition-colors",children:"Yes, Cancel Subscription"}),(0,s.jsx)("button",{onClick:()=>m(!1),className:"w-full px-6 py-3 border border-slate-600 text-slate-400 hover:bg-slate-700 transition-colors",children:"Keep Subscription"})]})]})})]}):(0,s.jsx)("div",{className:"text-center py-8",children:(0,s.jsx)("div",{className:"text-slate-400",children:"Loading subscription details..."})})}var k=e.i(75254);let C=(0,k.default)("download",[["path",{d:"M12 15V3",key:"m9g1x1"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["path",{d:"m7 10 5 5 5-5",key:"brsn70"}]]),A=(0,k.default)("file-text",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]]),T=(0,k.default)("file-spreadsheet",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M8 13h2",key:"yr2amv"}],["path",{d:"M14 13h2",key:"un5t4a"}],["path",{d:"M8 17h2",key:"2yhykz"}],["path",{d:"M14 17h2",key:"10kma7"}]]);var E=e.i(38957),M=e.i(30945),D=e.i(88368);function F(){let{user:e}=(0,t.useAuth)(),{formatAmount:a,currency:r}=(0,E.useCurrency)(),{canAccessFeature:l}=(0,x.useSubscription)(),[i,n]=(0,u.useState)(!1),[d,c]=(0,u.useState)(!1),[o,m]=(0,u.useState)(!1),[h,b]=(0,u.useState)("csv"),p=l("export"),g=e=>e.toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}),j=(e,s)=>{let t=Object.keys(e[0]||{}),a=new Blob([[t.join(","),...e.map(e=>t.map(s=>{let t=e[s];return"string"==typeof t&&(t.includes(",")||t.includes('"'))?`"${t.replace(/"/g,'""')}"`:t||""}).join(","))].join("\n")],{type:"text/csv;charset=utf-8;"}),r=document.createElement("a"),l=URL.createObjectURL(a);r.setAttribute("href",l),r.setAttribute("download",s),r.style.visibility="hidden",document.body.appendChild(r),r.click(),document.body.removeChild(r)},f=(e,s)=>{let t=new Blob([JSON.stringify(e,null,2)],{type:"application/json;charset=utf-8;"}),a=document.createElement("a"),r=URL.createObjectURL(t);a.setAttribute("href",r),a.setAttribute("download",s),a.style.visibility="hidden",document.body.appendChild(a),a.click(),document.body.removeChild(a)},v=async()=>{if(e&&p){n(!0);try{let[s,t]=await Promise.all([M.transactionsService.getRecentByUserId(e.uid,1e4),M.cardsService.getByUserId(e.uid)]),l=new Map;t.forEach(e=>{e.id&&l.set(e.id,e.lastFour||"****")});let i=s.map(e=>({Date:g(e.date),Type:e.type,Category:e.category,Description:e.description,Amount:e.amount,Currency:r.code,Formatted_Amount:a(e.amount),Card_Last_4:e.cardId?l.get(e.cardId)||"****":"",Savings_Account_ID:e.savingsAccountId||"",Is_Recurring:e.isRecurring?"Yes":"No",Recurring_Frequency:e.recurringFrequency||"",Created:g(e.createdAt),Updated:g(e.updatedAt)})),n=`spendflow_transactions_${new Date().toISOString().split("T")[0]}.${h}`;"csv"===h?j(i,n):f(i,n),D.default.success(`Exported ${s.length} transactions successfully!`)}catch(e){console.error("Export error:",e),D.default.error("Failed to export transactions")}finally{n(!1)}}},N=async()=>{if(e&&p){c(!0);try{let s=await M.cardsService.getByUserId(e.uid),t=s.map(e=>({Name:e.name||e.type,Type:e.type,Last_Four:e.lastFour||"****",Balance:e.balance,Currency:r.code,Formatted_Balance:a(e.balance),Credit_Limit:e.limit||"",Formatted_Limit:e.limit?a(e.limit):"",Active:e.isActive?"Yes":"No",Created:g(e.createdAt),Updated:g(e.updatedAt)})),l=`spendflow_cards_${new Date().toISOString().split("T")[0]}.${h}`;"csv"===h?j(t,l):f(t,l),D.default.success(`Exported ${s.length} cards successfully!`)}catch(e){console.error("Export error:",e),D.default.error("Failed to export cards")}finally{c(!1)}}},y=async()=>{if(e&&p){m(!0);try{let[s,t]=await Promise.all([M.transactionsService.getRecentByUserId(e.uid,1e4),M.cardsService.getByUserId(e.uid)]),l=s.filter(e=>"income"===e.type).reduce((e,s)=>e+s.amount,0),i=s.filter(e=>"expense"===e.type).reduce((e,s)=>e+s.amount,0),n=t.reduce((e,s)=>e+s.balance,0),d={Export_Date:new Date().toISOString(),User_ID:e.uid,Currency:r.code,Summary:{Total_Balance:n,Formatted_Balance:a(n),Total_Income:l,Formatted_Income:a(l),Total_Expenses:i,Formatted_Expenses:a(i),Net_Savings:l-i,Formatted_Net_Savings:a(l-i),Total_Transactions:s.length,Active_Cards:t.filter(e=>e.isActive).length,Total_Cards:t.length},Transactions_Summary:s.reduce((e,s)=>{let t=s.date.toISOString().slice(0,7);return e[t]||(e[t]={income:0,expenses:0,count:0}),"income"===s.type?e[t].income+=s.amount:e[t].expenses+=s.amount,e[t].count+=1,e},{})},c=`spendflow_financial_summary_${new Date().toISOString().split("T")[0]}.${h}`;if("csv"===h){let e=[{Metric:"Export Date",Value:d.Export_Date},{Metric:"Total Balance",Value:d.Summary.Formatted_Balance},{Metric:"Total Income",Value:d.Summary.Formatted_Income},{Metric:"Total Expenses",Value:d.Summary.Formatted_Expenses},{Metric:"Net Savings",Value:d.Summary.Formatted_Net_Savings},{Metric:"Total Transactions",Value:d.Summary.Total_Transactions.toString()},{Metric:"Active Cards",Value:d.Summary.Active_Cards.toString()}];j(e,c)}else f(d,c);D.default.success("Financial summary exported successfully!")}catch(e){console.error("Export error:",e),D.default.error("Failed to export financial summary")}finally{m(!1)}}};return p?(0,s.jsxs)("div",{className:"bg-slate-900/50 border border-slate-800 backdrop-blur-sm p-6 rounded-lg",children:[(0,s.jsxs)("div",{className:"flex items-center gap-3 mb-6",children:[(0,s.jsx)(T,{className:"h-6 w-6 text-amber-400"}),(0,s.jsx)("h3",{className:"text-lg font-semibold text-slate-100",children:"Data Export"})]}),(0,s.jsxs)("div",{className:"mb-6",children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:"Export Format"}),(0,s.jsxs)("div",{className:"flex gap-4",children:[(0,s.jsxs)("label",{className:"flex items-center gap-2",children:[(0,s.jsx)("input",{type:"radio",value:"csv",checked:"csv"===h,onChange:e=>b(e.target.value),className:"text-amber-400 focus:ring-amber-500"}),(0,s.jsx)("span",{className:"text-slate-300",children:"CSV (Excel compatible)"})]}),(0,s.jsxs)("label",{className:"flex items-center gap-2",children:[(0,s.jsx)("input",{type:"radio",value:"json",checked:"json"===h,onChange:e=>b(e.target.value),className:"text-amber-400 focus:ring-amber-500"}),(0,s.jsx)("span",{className:"text-slate-300",children:"JSON (Developer friendly)"})]})]})]}),(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between p-4 border border-slate-700 rounded-md",children:[(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[(0,s.jsx)(A,{className:"h-5 w-5 text-blue-400"}),(0,s.jsxs)("div",{children:[(0,s.jsx)("h4",{className:"font-medium text-slate-200",children:"Transactions"}),(0,s.jsx)("p",{className:"text-sm text-slate-400",children:"All your income and expense records"})]})]}),(0,s.jsxs)("button",{onClick:v,disabled:i,className:"px-4 py-2 bg-blue-600 hover:bg-blue-700 disabled:bg-slate-600 text-white text-sm font-medium rounded-md transition-colors flex items-center gap-2",children:[(0,s.jsx)(C,{className:"h-4 w-4"}),i?"Exporting...":"Export"]})]}),(0,s.jsxs)("div",{className:"flex items-center justify-between p-4 border border-slate-700 rounded-md",children:[(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[(0,s.jsx)(T,{className:"h-5 w-5 text-green-400"}),(0,s.jsxs)("div",{children:[(0,s.jsx)("h4",{className:"font-medium text-slate-200",children:"Cards & Accounts"}),(0,s.jsx)("p",{className:"text-sm text-slate-400",children:"Your card balances and account details"})]})]}),(0,s.jsxs)("button",{onClick:N,disabled:d,className:"px-4 py-2 bg-green-600 hover:bg-green-700 disabled:bg-slate-600 text-white text-sm font-medium rounded-md transition-colors flex items-center gap-2",children:[(0,s.jsx)(C,{className:"h-4 w-4"}),d?"Exporting...":"Export"]})]}),(0,s.jsxs)("div",{className:"flex items-center justify-between p-4 border border-slate-700 rounded-md",children:[(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[(0,s.jsx)(A,{className:"h-5 w-5 text-amber-400"}),(0,s.jsxs)("div",{children:[(0,s.jsx)("h4",{className:"font-medium text-slate-200",children:"Financial Summary"}),(0,s.jsx)("p",{className:"text-sm text-slate-400",children:"Overview of your financial health"})]})]}),(0,s.jsxs)("button",{onClick:y,disabled:o,className:"px-4 py-2 bg-amber-600 hover:bg-amber-700 disabled:bg-slate-600 text-white text-sm font-medium rounded-md transition-colors flex items-center gap-2",children:[(0,s.jsx)(C,{className:"h-4 w-4"}),o?"Exporting...":"Export"]})]})]}),(0,s.jsx)("div",{className:"mt-6 p-4 bg-slate-800/50 rounded-md",children:(0,s.jsxs)("p",{className:"text-xs text-slate-400",children:["ðŸ’¡ ",(0,s.jsx)("strong",{children:"Tip:"})," Exported files are saved to your Downloads folder. CSV files can be opened in Excel, Google Sheets, or any spreadsheet application."]})})]}):(0,s.jsx)("div",{className:"bg-slate-900/50 border border-slate-800 backdrop-blur-sm p-6 rounded-lg",children:(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)(T,{className:"h-12 w-12 text-slate-600 mx-auto mb-4"}),(0,s.jsx)("h3",{className:"text-lg font-semibold text-slate-400 mb-2",children:"Data Export"}),(0,s.jsx)("p",{className:"text-slate-500 mb-4",children:"Export your financial data for accounting and analysis."}),(0,s.jsx)("div",{className:"bg-amber-900/20 border border-amber-700/50 rounded-md p-4",children:(0,s.jsxs)("p",{className:"text-amber-300 text-sm",children:["ðŸ”’ Data export is available with Pro and Enterprise plans.",(0,s.jsx)("a",{href:"/subscription",className:"text-amber-400 hover:text-amber-300 underline ml-1",children:"Upgrade now"})]})})]})})}var L=e.i(17923),I=e.i(25652);let U=(0,k.default)("chart-pie",[["path",{d:"M21 12c.552 0 1.005-.449.95-.998a10 10 0 0 0-8.953-8.951c-.55-.055-.998.398-.998.95v8a1 1 0 0 0 1 1z",key:"pzmjnu"}],["path",{d:"M21.21 15.89A10 10 0 1 1 8 2.83",key:"k2fpak"}]]);var B=e.i(12426);let _=["#3b82f6","#ef4444","#10b981","#f59e0b","#8b5cf6","#06b6d4","#84cc16","#f97316","#ec4899","#6b7280"];function O(){let{user:e}=(0,t.useAuth)(),{formatAmount:a}=(0,E.useCurrency)(),{canAccessFeature:r}=(0,x.useSubscription)(),[l,i]=(0,u.useState)(null),[n,d]=(0,u.useState)(!0),[c,o]=(0,u.useState)("3M"),m=r("analytics");(0,u.useEffect)(()=>{e&&m?h():d(!1)},[e,m,c]);let h=async()=>{try{d(!0),console.log("AdvancedAnalytics: Loading analytics for user:",e.uid,"timeRange:",c);let s=await M.transactionsService.getRecentByUserId(e.uid,1e3);console.log("AdvancedAnalytics: Fetched",s.length,"transactions");let t=new Date,a="1M"===c?1:"3M"===c?3:"6M"===c?6:12,r=new Date(t.getFullYear(),t.getMonth()-a,1),l=s.filter(e=>e.date>=r);console.log("AdvancedAnalytics: Filtered to",l.length,"transactions for time range");let n=b(l);i(n),console.log("AdvancedAnalytics: Analytics processed successfully")}catch(e){console.error("AdvancedAnalytics: Error loading analytics:",e),e instanceof Error&&(console.error("AdvancedAnalytics: Error details:",{message:e.message,name:e.name,stack:e.stack}),e.message.includes("quota")?console.error("AdvancedAnalytics: Firebase quota exceeded"):e.message.includes("permission")?console.error("AdvancedAnalytics: Permission denied"):e.message.includes("unavailable")&&console.error("AdvancedAnalytics: Service unavailable")),i(null)}finally{d(!1)}},b=e=>{let s={},t={},a={},r={},l=0,i=null;e.forEach(e=>{let n=e.date.toISOString().slice(0,7);"expense"===e.type&&(s[n]=(s[n]||0)+e.amount),t[n]||(t[n]={income:0,expenses:0}),"income"===e.type?t[n].income+=e.amount:t[n].expenses+=e.amount,"expense"===e.type&&(a[e.category]=(a[e.category]||0)+e.amount,r[e.category]=(r[e.category]||0)+1),l+=e.amount,(!i||e.amount>i.amount)&&(i=e)});let n=Object.entries(s).sort(([e],[s])=>e.localeCompare(s)).map(([e,s])=>({month:new Date(e+"-01").toLocaleDateString("en-US",{month:"short",year:"numeric"}),amount:s})),d=Object.entries(t).sort(([e],[s])=>e.localeCompare(s)).map(([e,s])=>({month:new Date(e+"-01").toLocaleDateString("en-US",{month:"short"}),income:s.income,expenses:s.expenses})),c=Object.values(a).reduce((e,s)=>e+s,0),o=Object.entries(a).sort(([,e],[,s])=>s-e).slice(0,8).map(([e,s],t)=>({category:e,amount:s,percentage:s/c*100,color:_[t%_.length]})),m=Object.entries(a).sort(([,e],[,s])=>s-e).slice(0,5).map(([e,s])=>({category:e,amount:s,count:r[e]||0})),x=new Date;x.setDate(x.getDate()-30);let u=e.filter(e=>e.date>=x&&"expense"===e.type).sort((e,s)=>e.date.getTime()-s.date.getTime()),h={};return u.forEach(e=>{let s=e.date.toISOString().split("T")[0];h[s]=(h[s]||0)+e.amount}),{monthlySpending:n,categoryBreakdown:o,incomeVsExpenses:d,topCategories:m,spendingTrends:Object.entries(h).sort(([e],[s])=>e.localeCompare(s)).map(([e,s])=>({date:new Date(e).toLocaleDateString("en-US",{month:"short",day:"numeric"}),amount:s})),averageTransaction:e.length>0?l/e.length:0,largestTransaction:i,totalTransactions:e.length}};return m?n?(0,s.jsx)("div",{className:"bg-slate-900/50 border border-slate-800 backdrop-blur-sm p-6 rounded-lg",children:(0,s.jsxs)("div",{className:"flex items-center justify-center py-12",children:[(0,s.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-2 border-amber-400 border-t-transparent"}),(0,s.jsx)("span",{className:"ml-3 text-slate-400",children:"Loading analytics..."})]})}):l||n?(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[(0,s.jsx)(L.BarChart3,{className:"h-6 w-6 text-amber-400"}),(0,s.jsx)("h3",{className:"text-lg font-semibold text-slate-100",children:"Advanced Analytics"})]}),(0,s.jsx)("div",{className:"flex gap-2",children:["1M","3M","6M","1Y"].map(e=>(0,s.jsx)("button",{onClick:()=>o(e),className:`px-3 py-1 text-xs font-medium rounded-md transition-colors ${c===e?"bg-amber-600 text-white":"bg-slate-700 text-slate-300 hover:bg-slate-600"}`,children:e},e))})]}),(0,s.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4",children:[(0,s.jsxs)("div",{className:"bg-slate-900/50 border border-slate-800 p-4 rounded-lg",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,s.jsx)(B.DollarSign,{className:"h-4 w-4 text-green-400"}),(0,s.jsx)("span",{className:"text-sm text-slate-400",children:"Avg Transaction"})]}),(0,s.jsx)("div",{className:"text-xl font-bold text-slate-100",children:a(l.averageTransaction)})]}),(0,s.jsxs)("div",{className:"bg-slate-900/50 border border-slate-800 p-4 rounded-lg",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,s.jsx)(I.TrendingUp,{className:"h-4 w-4 text-blue-400"}),(0,s.jsx)("span",{className:"text-sm text-slate-400",children:"Largest Transaction"})]}),(0,s.jsx)("div",{className:"text-xl font-bold text-slate-100",children:l.largestTransaction?a(l.largestTransaction.amount):a(0)})]}),(0,s.jsxs)("div",{className:"bg-slate-900/50 border border-slate-800 p-4 rounded-lg",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,s.jsx)(L.BarChart3,{className:"h-4 w-4 text-amber-400"}),(0,s.jsx)("span",{className:"text-sm text-slate-400",children:"Total Transactions"})]}),(0,s.jsx)("div",{className:"text-xl font-bold text-slate-100",children:l.totalTransactions})]}),(0,s.jsxs)("div",{className:"bg-slate-900/50 border border-slate-800 p-4 rounded-lg",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,s.jsx)(U,{className:"h-4 w-4 text-purple-400"}),(0,s.jsx)("span",{className:"text-sm text-slate-400",children:"Categories"})]}),(0,s.jsx)("div",{className:"text-xl font-bold text-slate-100",children:l.categoryBreakdown.length})]})]}),(0,s.jsxs)("div",{className:"bg-slate-900/50 border border-slate-800 backdrop-blur-sm p-6 rounded-lg",children:[(0,s.jsx)("h4",{className:"text-slate-200 font-semibold mb-4",children:"Monthly Spending Trend"}),(0,s.jsx)("div",{className:"space-y-3",children:l.monthlySpending.map((e,t)=>(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsx)("span",{className:"text-slate-300",children:e.month}),(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[(0,s.jsx)("div",{className:"w-24 bg-slate-700 rounded-full h-2",children:(0,s.jsx)("div",{className:"bg-amber-500 h-2 rounded-full",style:{width:`${Math.min(e.amount/Math.max(...l.monthlySpending.map(e=>e.amount))*100,100)}%`}})}),(0,s.jsx)("span",{className:"text-slate-300 font-medium w-20 text-right",children:a(e.amount)})]})]},t))})]}),(0,s.jsxs)("div",{className:"bg-slate-900/50 border border-slate-800 backdrop-blur-sm p-6 rounded-lg",children:[(0,s.jsx)("h4",{className:"text-slate-200 font-semibold mb-4",children:"Spending by Category"}),(0,s.jsx)("div",{className:"space-y-3",children:l.categoryBreakdown.map((e,t)=>(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[(0,s.jsx)("div",{className:"w-3 h-3 rounded-full",style:{backgroundColor:e.color}}),(0,s.jsx)("span",{className:"text-slate-300",children:e.category})]}),(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[(0,s.jsx)("div",{className:"w-20 bg-slate-700 rounded-full h-2",children:(0,s.jsx)("div",{className:"h-2 rounded-full",style:{width:`${e.percentage}%`,backgroundColor:e.color}})}),(0,s.jsxs)("span",{className:"text-slate-300 font-medium w-16 text-right",children:[e.percentage.toFixed(1),"%"]}),(0,s.jsx)("span",{className:"text-slate-300 font-medium w-24 text-right",children:a(e.amount)})]})]},t))})]}),(0,s.jsxs)("div",{className:"bg-slate-900/50 border border-slate-800 backdrop-blur-sm p-6 rounded-lg",children:[(0,s.jsx)("h4",{className:"text-slate-200 font-semibold mb-4",children:"Top Spending Categories"}),(0,s.jsx)("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4",children:l.topCategories.map((e,t)=>(0,s.jsxs)("div",{className:"bg-slate-800/50 p-4 rounded-md",children:[(0,s.jsx)("div",{className:"text-slate-300 text-sm mb-1",children:e.category}),(0,s.jsx)("div",{className:"text-xl font-bold text-slate-100 mb-1",children:a(e.amount)}),(0,s.jsxs)("div",{className:"text-slate-500 text-xs",children:[e.count," transactions"]})]},t))})]}),(0,s.jsxs)("div",{className:"bg-slate-900/50 border border-slate-800 backdrop-blur-sm p-6 rounded-lg",children:[(0,s.jsx)("h4",{className:"text-slate-200 font-semibold mb-4",children:"Income vs Expenses"}),(0,s.jsx)("div",{className:"space-y-3",children:l.incomeVsExpenses.map((e,t)=>(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsx)("span",{className:"text-slate-300",children:e.month}),(0,s.jsxs)("div",{className:"flex items-center gap-4",children:[(0,s.jsxs)("div",{className:"text-green-400 text-sm",children:["+",a(e.income)]}),(0,s.jsxs)("div",{className:"text-red-400 text-sm",children:["-",a(e.expenses)]}),(0,s.jsx)("div",{className:`text-sm font-medium ${e.income-e.expenses>=0?"text-green-400":"text-red-400"}`,children:a(e.income-e.expenses)})]})]},t))})]})]}):(0,s.jsx)("div",{className:"bg-slate-900/50 border border-slate-800 backdrop-blur-sm p-6 rounded-lg",children:(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)(L.BarChart3,{className:"h-12 w-12 text-red-600 mx-auto mb-4"}),(0,s.jsx)("h3",{className:"text-lg font-semibold text-slate-400 mb-2",children:"Analytics Unavailable"}),(0,s.jsx)("p",{className:"text-slate-500 text-sm mb-4",children:"Unable to load analytics data. This may be due to a temporary service issue."}),(0,s.jsx)("button",{onClick:h,className:"px-4 py-2 bg-amber-600 hover:bg-amber-700 text-white rounded-md transition-colors text-sm",children:"Try Again"})]})}):(0,s.jsx)("div",{className:"bg-slate-900/50 border border-slate-800 backdrop-blur-sm p-6 rounded-lg",children:(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)(L.BarChart3,{className:"h-12 w-12 text-slate-600 mx-auto mb-4"}),(0,s.jsx)("h3",{className:"text-lg font-semibold text-slate-400 mb-2",children:"Advanced Analytics"}),(0,s.jsx)("p",{className:"text-slate-500 mb-4",children:"Get deep insights into your spending patterns and financial trends."}),(0,s.jsx)("div",{className:"bg-amber-900/20 border border-amber-700/50 rounded-md p-4",children:(0,s.jsxs)("p",{className:"text-amber-300 text-sm",children:["ðŸ“Š Advanced analytics are available with Pro and Enterprise plans.",(0,s.jsx)("a",{href:"/subscription",className:"text-amber-400 hover:text-amber-300 underline ml-1",children:"Upgrade now"})]})})]})})}var q=e.i(61911),$=e.i(7233);let P=(0,k.default)("share",[["path",{d:"M12 2v13",key:"1km8f5"}],["path",{d:"m16 6-4-4-4 4",key:"13yo43"}],["path",{d:"M4 12v8a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2v-8",key:"1b2hhj"}]]),R=(0,k.default)("user-plus",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]]);e.i(95299);var Y=e.i(59672);e.i(64637);var V=e.i(60333);class z{static instance;functions=(0,Y.getFunctions)((0,V.getApp)());constructor(){}static getInstance(){return z.instance||(z.instance=new z),z.instance}async createTeam(e,s){try{let t=(0,Y.httpsCallable)(this.functions,"createTeam"),a=await t({name:e,description:s});if(!a.data||"object"!=typeof a.data)throw Error("Invalid response from server");let r=a.data;if(!r.success)throw Error(r.message||"Failed to create team");return{teamId:r.teamId,message:r.message||"Team created successfully"}}catch(e){throw console.error("Error creating team:",e),e}}async getUserTeam(){try{let e=(0,Y.httpsCallable)(this.functions,"getUserTeam"),s=await e();if(!s.data||"object"!=typeof s.data)return null;let t=s.data;if(!t.success)return null;return{team:t.team?{...t.team,createdAt:new Date(t.team.createdAt),updatedAt:new Date(t.team.updatedAt)}:null,role:t.role||null,memberSince:t.memberSince?new Date(t.memberSince):null}}catch(e){throw console.error("Error getting user team:",e),e}}async getTeamMembers(){try{let e=(0,Y.httpsCallable)(this.functions,"getTeamMembers"),s=await e();if(!s.data||"object"!=typeof s.data)throw Error("Invalid response from server");let t=s.data;if(!t.success)throw Error("Failed to get team members");return{members:(t.members||[]).map(e=>({...e,joinedAt:new Date(e.joinedAt),invitationAcceptedAt:e.invitationAcceptedAt?new Date(e.invitationAcceptedAt):void 0})),userRole:t.userRole}}catch(e){throw console.error("Error getting team members:",e),e}}async inviteTeamMember(e){try{let s=(0,Y.httpsCallable)(this.functions,"inviteTeamMember"),t=await s({email:e});if(!t.data||"object"!=typeof t.data)throw Error("Invalid response from server");let a=t.data;if(!a.success)throw Error(a.message||"Failed to send invitation");return{message:a.message||"Invitation sent successfully"}}catch(e){throw console.error("Error inviting team member:",e),e}}async createSharedExpense(e){try{let s=(0,Y.httpsCallable)(this.functions,"createSharedExpense"),t=await s({...e,date:e.date.toISOString()});if(!t.data||"object"!=typeof t.data)throw Error("Invalid response from server");let a=t.data;if(!a.success)throw Error(a.message||"Failed to create shared expense");return{expenseId:a.expenseId,message:a.message||"Shared expense created successfully"}}catch(e){throw console.error("Error creating shared expense:",e),e}}async getSharedExpenses(){try{let e=(0,Y.httpsCallable)(this.functions,"getSharedExpenses"),s=await e();if(!s.data||"object"!=typeof s.data)throw Error("Invalid response from server");let t=s.data;if(!t.success)throw Error("Failed to get shared expenses");return(t.expenses||[]).map(e=>({...e,date:new Date(e.date),createdAt:new Date(e.createdAt),updatedAt:new Date(e.updatedAt)}))}catch(e){throw console.error("Error getting shared expenses:",e),e}}calculateExpenseSplit(e,s){if(0===s.length)return{};let t=e/s.length,a={};return s.forEach(e=>{a[e]=t}),a}async getBalanceSummary(e){try{let s=await this.getSharedExpenses(),t={},a={},r=0;return s.forEach(s=>{if(s.splitBetween.includes(e)){let l=s.amount/s.splitBetween.length;s.paidBy===e?s.splitBetween.forEach(s=>{s!==e&&(a[s]=(a[s]||0)+l,r+=l)}):(t[s.paidBy]=(t[s.paidBy]||0)+l,r-=l)}}),{owes:t,owed:a,netBalance:r}}catch(e){throw console.error("Error calculating balance summary:",e),e}}}let W=z.getInstance();function G(){let{user:e}=(0,t.useAuth)(),{canAccessFeature:a}=(0,x.useSubscription)(),{formatAmount:r}=(0,E.useCurrency)(),[l,i]=(0,u.useState)([]),[n,d]=(0,u.useState)([]),[c,o]=(0,u.useState)(!1),[m,h]=(0,u.useState)(!1),[b,p]=(0,u.useState)(!0),g=a("analytics");(0,u.useEffect)(()=>{e&&g?j():g||p(!1)},[e,g]);let j=async()=>{try{p(!0);let[e,s]=await Promise.allSettled([W.getTeamMembers(),W.getSharedExpenses()]);"fulfilled"===e.status?i(e.value.members):(console.error("Failed to load team members:",e.reason),D.default.error("Failed to load team members")),"fulfilled"===s.status?d(s.value):(console.error("Failed to load shared expenses:",s.reason),D.default.error("Failed to load shared expenses"))}catch(e){console.error("Error loading team data:",e),D.default.error("Failed to load team data")}finally{p(!1)}},f=async e=>{try{let s=await W.inviteTeamMember(e);D.default.success(s.message),o(!1)}catch(e){console.error("Error inviting member:",e),D.default.error(e instanceof Error?e.message:"Failed to send invitation")}},v=async e=>{try{let s=await W.createSharedExpense(e);D.default.success(s.message),h(!1);let t=await W.getSharedExpenses();d(t)}catch(e){console.error("Error creating shared expense:",e),D.default.error(e instanceof Error?e.message:"Failed to create shared expense")}};return g?(0,s.jsxs)("div",{className:"bg-slate-900/50 border border-slate-800 backdrop-blur-sm p-6 rounded-lg",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[(0,s.jsx)(q.Users,{className:"h-6 w-6 text-amber-400"}),(0,s.jsx)("h3",{className:"text-lg font-semibold text-slate-100",children:"Team Collaboration"})]}),(0,s.jsxs)("div",{className:"flex gap-3",children:[(0,s.jsxs)("button",{onClick:()=>o(!0),className:"px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white text-sm font-medium rounded-md transition-colors flex items-center gap-2",children:[(0,s.jsx)(R,{className:"h-4 w-4"}),"Invite Member"]}),(0,s.jsxs)("button",{onClick:()=>h(!0),className:"px-4 py-2 bg-amber-600 hover:bg-amber-700 text-white text-sm font-medium rounded-md transition-colors flex items-center gap-2",children:[(0,s.jsx)($.Plus,{className:"h-4 w-4"}),"Shared Expense"]})]})]}),b?(0,s.jsxs)("div",{className:"flex items-center justify-center py-12",children:[(0,s.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-2 border-amber-400 border-t-transparent"}),(0,s.jsx)("span",{className:"ml-3 text-slate-400",children:"Loading team data..."})]}):(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsxs)("div",{children:[(0,s.jsxs)("h4",{className:"text-slate-200 font-semibold mb-4",children:["Team Members (",l.length,")"]}),(0,s.jsx)("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4",children:l.map(e=>(0,s.jsxs)("div",{className:"bg-slate-800/50 border border-slate-700 rounded-lg p-4",children:[(0,s.jsxs)("div",{className:"flex items-start justify-between mb-3",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h5",{className:"font-semibold text-slate-200",children:e.displayName}),(0,s.jsx)("p",{className:"text-slate-400 text-sm",children:e.email})]}),(0,s.jsx)("span",{className:`px-2 py-1 text-xs font-medium rounded-full ${"owner"===e.role?"bg-amber-600 text-slate-900":"admin"===e.role?"bg-blue-600 text-white":"bg-slate-600 text-slate-200"}`,children:e.role})]}),(0,s.jsxs)("div",{className:"text-slate-500 text-xs",children:["Joined ",e.joinedAt.toLocaleDateString()]})]},e.id))})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("h4",{className:"text-slate-200 font-semibold mb-4",children:"Shared Expenses"}),0===n.length?(0,s.jsxs)("div",{className:"text-center py-8 bg-slate-800/50 rounded-lg",children:[(0,s.jsx)(P,{className:"h-12 w-12 text-slate-600 mx-auto mb-4"}),(0,s.jsx)("h5",{className:"text-slate-400 font-semibold mb-2",children:"No Shared Expenses"}),(0,s.jsx)("p",{className:"text-slate-500 text-sm mb-4",children:"Create your first shared expense to get started."}),(0,s.jsx)("button",{onClick:()=>h(!0),className:"px-4 py-2 bg-amber-600 hover:bg-amber-700 text-white text-sm font-medium rounded-md transition-colors",children:"Create Shared Expense"})]}):(0,s.jsx)("div",{className:"space-y-3",children:n.map(e=>(0,s.jsx)("div",{className:"bg-slate-800/50 border border-slate-700 rounded-lg p-4",children:(0,s.jsxs)("div",{className:"flex items-start justify-between",children:[(0,s.jsxs)("div",{className:"flex-1",children:[(0,s.jsx)("h5",{className:"font-semibold text-slate-200 mb-1",children:e.title}),(0,s.jsx)("p",{className:"text-slate-400 text-sm mb-2",children:e.description}),(0,s.jsxs)("div",{className:"flex items-center gap-4 text-sm text-slate-500",children:[(0,s.jsx)("span",{children:e.category}),(0,s.jsx)("span",{children:e.date.toLocaleDateString()}),(0,s.jsxs)("span",{children:["Paid by ",e.paidByName]})]})]}),(0,s.jsxs)("div",{className:"text-right",children:[(0,s.jsx)("div",{className:"text-xl font-bold text-slate-100",children:r(e.amount)}),(0,s.jsxs)("div",{className:"text-slate-500 text-sm",children:["Split ",e.splitBetween.length," ways"]})]})]})},e.id))})]})]}),c&&(0,s.jsx)(H,{onClose:()=>o(!1),onInvite:f}),m&&(0,s.jsx)(J,{onClose:()=>h(!1),onCreate:v,teamMembers:l})]}):(0,s.jsx)("div",{className:"bg-slate-900/50 border border-slate-800 backdrop-blur-sm p-6 rounded-lg",children:(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)(q.Users,{className:"h-12 w-12 text-slate-600 mx-auto mb-4"}),(0,s.jsx)("h3",{className:"text-lg font-semibold text-slate-400 mb-2",children:"Team Collaboration"}),(0,s.jsx)("p",{className:"text-slate-500 mb-4",children:"Share expenses and collaborate with your team members."}),(0,s.jsx)("div",{className:"bg-amber-900/20 border border-amber-700/50 rounded-md p-4",children:(0,s.jsxs)("p",{className:"text-amber-300 text-sm",children:["ðŸ‘¥ Team collaboration features are available with Enterprise plans.",(0,s.jsx)("a",{href:"/subscription",className:"text-amber-400 hover:text-amber-300 underline ml-1",children:"Upgrade now"})]})})]})})}function H({onClose:e,onInvite:t}){let[a,r]=(0,u.useState)("");return(0,s.jsx)("div",{className:"fixed inset-0 bg-black/80 backdrop-blur-sm flex items-center justify-center p-4 z-40",children:(0,s.jsxs)("div",{className:"bg-slate-950 border border-amber-700/30 rounded-lg shadow-2xl max-w-md w-full p-6",children:[(0,s.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,s.jsx)("h3",{className:"text-xl font-serif text-slate-100",children:"Invite Team Member"}),(0,s.jsx)("button",{onClick:e,className:"text-slate-400 hover:text-slate-200 transition-colors",children:(0,s.jsx)("svg",{className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),(0,s.jsxs)("form",{onSubmit:e=>{e.preventDefault(),a.trim()&&(t(a.trim()),r(""))},className:"space-y-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:"Email Address"}),(0,s.jsx)("input",{type:"email",value:a,onChange:e=>r(e.target.value),className:"w-full bg-slate-800 border border-slate-700 rounded-md px-4 py-2 text-slate-200 focus:outline-none focus:ring-2 focus:ring-amber-500",placeholder:"colleague@company.com",required:!0})]}),(0,s.jsx)("div",{className:"bg-blue-900/20 border border-blue-700/50 rounded-md p-4",children:(0,s.jsx)("p",{className:"text-blue-300 text-sm",children:"ðŸ“§ An invitation will be sent to this email address. They can join your team and start collaborating on shared expenses."})}),(0,s.jsxs)("div",{className:"flex justify-end gap-3 pt-4",children:[(0,s.jsx)("button",{type:"button",onClick:e,className:"px-4 py-2 text-slate-300 hover:text-slate-100 transition-colors",children:"Cancel"}),(0,s.jsx)("button",{type:"submit",className:"px-4 py-2 bg-amber-600 hover:bg-amber-700 text-white font-medium rounded-md transition-colors",children:"Send Invitation"})]})]})]})})}function J({onClose:e,onCreate:t,teamMembers:a}){let[r,l]=(0,u.useState)({title:"",amount:"",category:"Food",splitBetween:[],date:new Date().toISOString().split("T")[0],description:""});return(0,s.jsx)("div",{className:"fixed inset-0 bg-black/80 backdrop-blur-sm flex items-center justify-center p-4 z-40",children:(0,s.jsxs)("div",{className:"bg-slate-950 border border-amber-700/30 rounded-lg shadow-2xl max-w-2xl w-full p-6",children:[(0,s.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,s.jsx)("h3",{className:"text-xl font-serif text-slate-100",children:"Create Shared Expense"}),(0,s.jsx)("button",{onClick:e,className:"text-slate-400 hover:text-slate-200 transition-colors",children:(0,s.jsx)("svg",{className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),(0,s.jsxs)("form",{onSubmit:e=>{e.preventDefault(),r.title.trim()&&r.amount&&0!==r.splitBetween.length&&t({title:r.title.trim(),amount:parseFloat(r.amount),category:r.category,splitBetween:r.splitBetween,date:new Date(r.date),description:r.description.trim()||void 0})},className:"space-y-4",children:[(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:"Title"}),(0,s.jsx)("input",{type:"text",value:r.title,onChange:e=>l(s=>({...s,title:e.target.value})),className:"w-full bg-slate-800 border border-slate-700 rounded-md px-4 py-2 text-slate-200 focus:outline-none focus:ring-2 focus:ring-amber-500",placeholder:"Team lunch",required:!0})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:"Amount"}),(0,s.jsx)("input",{type:"number",step:"0.01",value:r.amount,onChange:e=>l(s=>({...s,amount:e.target.value})),className:"w-full bg-slate-800 border border-slate-700 rounded-md px-4 py-2 text-slate-200 focus:outline-none focus:ring-2 focus:ring-amber-500",placeholder:"45.50",required:!0})]})]}),(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:"Category"}),(0,s.jsxs)("select",{value:r.category,onChange:e=>l(s=>({...s,category:e.target.value})),className:"w-full bg-slate-800 border border-slate-700 rounded-md px-4 py-2 text-slate-200 focus:outline-none focus:ring-2 focus:ring-amber-500",children:[(0,s.jsx)("option",{value:"Food",children:"Food"}),(0,s.jsx)("option",{value:"Transportation",children:"Transportation"}),(0,s.jsx)("option",{value:"Entertainment",children:"Entertainment"}),(0,s.jsx)("option",{value:"Office",children:"Office"}),(0,s.jsx)("option",{value:"Travel",children:"Travel"}),(0,s.jsx)("option",{value:"Other",children:"Other"})]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:"Date"}),(0,s.jsx)("input",{type:"date",value:r.date,onChange:e=>l(s=>({...s,date:e.target.value})),className:"w-full bg-slate-800 border border-slate-700 rounded-md px-4 py-2 text-slate-200 focus:outline-none focus:ring-2 focus:ring-amber-500",required:!0})]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:"Description (Optional)"}),(0,s.jsx)("textarea",{value:r.description,onChange:e=>l(s=>({...s,description:e.target.value})),rows:2,className:"w-full bg-slate-800 border border-slate-700 rounded-md px-4 py-2 text-slate-200 focus:outline-none focus:ring-2 focus:ring-amber-500",placeholder:"Additional details about this expense..."})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-slate-300 mb-3",children:"Split Between (Select team members)"}),(0,s.jsx)("div",{className:"grid grid-cols-2 gap-2",children:a.map(e=>(0,s.jsxs)("label",{className:"flex items-center gap-3 p-3 bg-slate-800/50 rounded-md hover:bg-slate-700/50 cursor-pointer",children:[(0,s.jsx)("input",{type:"checkbox",checked:r.splitBetween.includes(e.userId),onChange:()=>{var s;return s=e.userId,void l(e=>({...e,splitBetween:e.splitBetween.includes(s)?e.splitBetween.filter(e=>e!==s):[...e.splitBetween,s]}))},className:"text-amber-400 focus:ring-amber-500"}),(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:"text-slate-200 font-medium",children:e.displayName}),(0,s.jsx)("div",{className:"text-slate-400 text-sm",children:e.email})]})]},e.id))})]}),(0,s.jsxs)("div",{className:"flex justify-end gap-3 pt-4",children:[(0,s.jsx)("button",{type:"button",onClick:e,className:"px-4 py-2 text-slate-300 hover:text-slate-100 transition-colors",children:"Cancel"}),(0,s.jsx)("button",{type:"submit",className:"px-4 py-2 bg-amber-600 hover:bg-amber-700 text-white font-medium rounded-md transition-colors",children:"Create Shared Expense"})]})]})]})})}var X=e.i(14764),K=e.i(3116),Q=e.i(29746);function Z({isOpen:e,onClose:t,onSubmit:a,isSending:r,formData:l,formErrors:i,onFormChange:n}){return e?(0,s.jsx)("div",{className:"fixed inset-0 bg-black/80 backdrop-blur-sm flex items-center justify-center p-4 z-50",children:(0,s.jsx)("div",{className:"bg-slate-900 border border-slate-700 rounded-lg shadow-xl w-full max-w-lg",children:(0,s.jsxs)("div",{className:"p-6",children:[(0,s.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,s.jsx)("h3",{className:"text-xl font-semibold text-slate-100",children:"Send us a Message"}),(0,s.jsx)("button",{onClick:t,className:"text-slate-400 hover:text-slate-200",disabled:r,children:(0,s.jsx)("svg",{className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),(0,s.jsxs)("form",{onSubmit:a,className:"space-y-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{htmlFor:"subject",className:"block text-sm font-medium text-slate-300 mb-2",children:"Subject"}),(0,s.jsx)("input",{type:"text",id:"subject",name:"subject",value:l.subject,onChange:n,className:`w-full px-3 py-2 bg-slate-800 border rounded-md text-white placeholder-slate-400 focus:outline-none focus:ring-2 focus:ring-amber-500 ${i?.subject?"border-red-500":"border-slate-600"}`,placeholder:"What's this about?",required:!0,disabled:r}),i?.subject&&(0,s.jsx)("p",{className:"text-red-400 text-sm mt-1",children:i.subject})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{htmlFor:"message",className:"block text-sm font-medium text-slate-300 mb-2",children:"Message"}),(0,s.jsx)("textarea",{id:"message",name:"message",value:l.message,onChange:n,rows:4,className:`w-full px-3 py-2 bg-slate-800 border rounded-md text-white placeholder-slate-400 focus:outline-none focus:ring-2 focus:ring-amber-500 ${i?.message?"border-red-500":"border-slate-600"}`,placeholder:"Tell us what's on your mind...",required:!0,disabled:r}),i?.message&&(0,s.jsx)("p",{className:"text-red-400 text-sm mt-1",children:i.message})]}),(0,s.jsxs)("div",{className:"flex justify-end space-x-3",children:[(0,s.jsx)("button",{type:"button",onClick:t,className:"px-4 py-2 text-sm font-medium text-slate-300 bg-slate-700 rounded-md hover:bg-slate-600 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-slate-500",disabled:r,children:"Cancel"}),(0,s.jsx)("button",{type:"submit",className:"px-4 py-2 text-sm font-medium text-white bg-amber-600 rounded-md hover:bg-amber-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-amber-500 disabled:bg-slate-600 disabled:cursor-not-allowed",disabled:r,children:r?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("div",{className:"animate-spin rounded-full h-4 w-4 border-2 border-white border-t-transparent mr-2"}),"Sending..."]}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(X.Send,{className:"h-4 w-4 mr-2"}),"Send Message"]})})]})]})]})})}):null}function ee({isOpen:e,onClose:a}){let{user:l}=(0,t.useAuth)(),[i,d]=(0,u.useState)([]),[c,o]=(0,u.useState)(""),[m,x]=(0,u.useState)(!1),[h,b]=(0,u.useState)("messages"),[p,g]=(0,u.useState)(!1),[j,f]=(0,u.useState)({subject:"",message:""}),[y,w]=(0,u.useState)(!1),[S,k]=(0,u.useState)({}),[C,A]=(0,u.useState)(!1),T=(0,u.useRef)(null);(0,u.useEffect)(()=>{if(e){A(!0);let e=setTimeout(()=>A(!1),3e3);return()=>clearTimeout(e)}},[e]),(0,u.useEffect)(()=>{T.current?.scrollIntoView({behavior:"smooth"})},[i]),(0,u.useEffect)(()=>{if(!l)return;let e=(0,v.query)((0,v.collection)(N.db,"contactMessages"),(0,v.where)("userId","==",l.uid),(0,v.orderBy)("createdAt","asc")),s=(0,v.query)((0,v.collection)(N.db,"messages"),(0,v.where)("to","==",l.uid),(0,v.where)("from","==","admin"),(0,v.orderBy)("createdAt","asc")),t=(0,v.onSnapshot)(e,e=>{let t=e.docs.map(e=>({id:e.id,from:e.data().userId,subject:e.data().subject||"Message",body:e.data().message,read:"new"!==e.data().status,hasAttachment:!1,labels:[],createdAt:e.data().createdAt?.toDate()||new Date,updatedAt:e.data().updatedAt?.toDate(),isFromUser:!0,userName:e.data().userName,userEmail:e.data().userEmail,replies:e.data().replies||[]})),a=(0,v.onSnapshot)(s,e=>{d([...t,...e.docs.map(e=>{let s=e.data();return{id:e.id,from:s.from,to:s.to,subject:s.subject||"Admin Reply",body:s.body,read:s.read||!1,hasAttachment:s.hasAttachment||!1,labels:s.labels||[],createdAt:s.createdAt?.toDate()||new Date,updatedAt:s.updatedAt?.toDate(),isFromUser:!1,userName:s.adminName||"SpendFlow Support",userEmail:"",adminReply:!0}})].sort((e,s)=>e.createdAt.getTime()-s.createdAt.getTime()))});return()=>a()});return()=>t()},[l]);let E=async e=>{if(e.preventDefault(),l&&c.trim()&&!m){x(!0);try{let e={userId:l.uid,userEmail:l.email,userName:l.displayName||"User",subject:"User Message",message:c.trim(),status:"new",createdAt:(0,v.serverTimestamp)(),updatedAt:(0,v.serverTimestamp)()};await (0,v.addDoc)((0,v.collection)(N.db,"contactMessages"),e),o(""),D.default.success("Message sent successfully!")}catch(e){console.error("Error sending message:",e),D.default.error("Failed to send message")}finally{x(!1)}}},M=async e=>{if(e.preventDefault(),!l)return;w(!0),k({});let s={};if(j.subject.trim()||(s.subject="Subject is required"),j.message.trim()||(s.message="Message is required"),Object.keys(s).length>0){k(s),w(!1);return}try{let e={userId:l.uid,userEmail:l.email,userName:l.displayName||"User",subject:j.subject.trim(),message:j.message.trim(),status:"new",createdAt:(0,v.serverTimestamp)(),updatedAt:(0,v.serverTimestamp)()};await (0,v.addDoc)((0,v.collection)(N.db,"contactMessages"),e),g(!1),f({subject:"",message:""}),D.default.success("Message sent successfully! We'll get back to you soon.")}catch(e){console.error("Error sending contact message:",e),D.default.error("Failed to send message. Please try again.")}finally{w(!1)}};return e?(0,s.jsx)("div",{className:"fixed inset-0 bg-black/80 backdrop-blur-sm flex items-center justify-center p-4 z-50",children:(0,s.jsx)("div",{className:"bg-slate-900/95 border border-slate-700 rounded-lg shadow-xl w-full max-w-4xl max-h-[90vh] overflow-y-auto",children:(0,s.jsxs)("div",{className:"p-6",children:[(0,s.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,s.jsx)("h3",{className:"text-xl font-semibold text-slate-100",children:"Support & Messages"}),(0,s.jsx)("button",{onClick:a,className:"text-slate-400 hover:text-slate-200",children:(0,s.jsx)("svg",{className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),C&&(0,s.jsx)("div",{className:"mb-6 p-4 bg-amber-900/20 border border-amber-600/30 rounded-lg animate-in slide-in-from-top-2 duration-500",children:(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[(0,s.jsx)("div",{className:"shrink-0",children:(0,s.jsx)("div",{className:"w-8 h-8 bg-amber-600 rounded-full flex items-center justify-center",children:(0,s.jsx)("span",{className:"text-white text-sm",children:"ðŸ‘‹"})})}),(0,s.jsxs)("div",{className:"flex-1",children:[(0,s.jsx)("h4",{className:"text-amber-300 font-medium text-sm",children:"Welcome to Support!"}),(0,s.jsx)("p",{className:"text-amber-200/80 text-xs",children:"We're here to help! Send us a message or use our contact form for detailed support."})]}),(0,s.jsx)("button",{onClick:()=>A(!1),className:"text-amber-400 hover:text-amber-200 text-sm",children:"âœ•"})]})}),(0,s.jsxs)("div",{className:"flex space-x-1 mb-6 bg-slate-800/50 p-1 rounded-lg",children:[(0,s.jsxs)("button",{onClick:()=>b("messages"),className:`flex-1 py-2 px-4 rounded-md text-sm font-medium transition-colors ${"messages"===h?"bg-amber-600 text-white":"text-slate-400 hover:text-slate-200 hover:bg-slate-700/50"}`,children:["ðŸ’¬ Messages (",i.length,")"]}),(0,s.jsx)("button",{onClick:()=>b("contact"),className:`flex-1 py-2 px-4 rounded-md text-sm font-medium transition-colors ${"contact"===h?"bg-amber-600 text-white":"text-slate-400 hover:text-slate-200 hover:bg-slate-700/50"}`,children:"ðŸ“§ Contact Form"})]}),"messages"===h?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("div",{className:"bg-slate-800/50 border border-slate-700 rounded-lg p-4 h-96 overflow-y-auto",children:0===i.length?(0,s.jsxs)("div",{className:"text-center py-8",children:[(0,s.jsx)(n.MessageSquare,{className:"h-12 w-12 text-slate-600 mx-auto mb-4"}),(0,s.jsx)("h4",{className:"text-slate-400 font-semibold mb-2",children:"No messages yet"}),(0,s.jsx)("p",{className:"text-slate-500 text-sm",children:"Send your first message to get started!"})]}):(0,s.jsxs)("div",{className:"space-y-4",children:[i.map(e=>(0,s.jsx)("div",{className:`flex ${e.isFromUser?"justify-end":"justify-start"}`,children:(0,s.jsxs)("div",{className:`max-w-xs lg:max-w-md px-4 py-2 rounded-lg ${e.isFromUser?"bg-amber-600 text-white":"bg-slate-700 text-slate-200"}`,children:[(0,s.jsx)("div",{className:"text-sm",children:e.body}),(0,s.jsxs)("div",{className:`text-xs mt-1 flex items-center gap-1 ${e.isFromUser?"text-amber-200":"text-slate-400"}`,children:[(0,s.jsx)(K.Clock,{className:"h-3 w-3"}),(0,Q.format)(e.createdAt,"MMM d, h:mm a"),(0,s.jsx)("span",{className:"ml-2 px-1.5 py-0.5 bg-slate-600 rounded text-xs",children:e.isFromUser?"You":"Admin"})]})]})},e.id)),(0,s.jsx)("div",{ref:T})]})}),(0,s.jsxs)("form",{onSubmit:E,className:"flex gap-3 mt-4",children:[(0,s.jsx)("input",{type:"text",value:c,onChange:e=>o(e.target.value),placeholder:"Type your message to admin...",className:"flex-1 bg-slate-800 border border-slate-700 rounded-md px-4 py-2 text-slate-200 focus:outline-none focus:ring-2 focus:ring-amber-500 focus:border-transparent",disabled:m}),(0,s.jsxs)("button",{type:"submit",disabled:!c.trim()||m,className:"px-4 py-2 bg-amber-600 hover:bg-amber-700 disabled:bg-slate-600 disabled:cursor-not-allowed text-white font-medium rounded-md transition-colors flex items-center gap-2",children:[m?(0,s.jsx)("div",{className:"animate-spin rounded-full h-4 w-4 border-2 border-white border-t-transparent"}):(0,s.jsx)(X.Send,{className:"h-4 w-4"}),"Send"]})]}),(0,s.jsx)("div",{className:"text-center mt-4",children:(0,s.jsx)("p",{className:"text-slate-500 text-sm",children:"ðŸ’¬ Your messages will be delivered to our support team. We'll respond as soon as possible!"})})]}):(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)(r.Mail,{className:"h-12 w-12 text-amber-400 mx-auto mb-4"}),(0,s.jsx)("h4",{className:"text-slate-200 font-semibold mb-2",children:"Send us a detailed message"}),(0,s.jsx)("p",{className:"text-slate-400 text-sm mb-6",children:"For complex questions, feature requests, or detailed feedback, use our contact form. We'll get back to you within 24 hours."})]}),(0,s.jsx)("div",{className:"text-center",children:(0,s.jsxs)("button",{onClick:()=>g(!0),className:"px-6 py-3 bg-amber-600 hover:bg-amber-700 text-white font-medium rounded-md transition-colors flex items-center gap-2 mx-auto mb-6",children:[(0,s.jsx)(r.Mail,{className:"h-5 w-5"}),"Open Contact Form"]})}),(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-4",children:[(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)("h5",{className:"text-slate-300 font-medium mb-2",children:"Quick Questions"}),(0,s.jsx)("p",{className:"text-slate-500 text-sm mb-3",children:"Use the Messages tab above"}),(0,s.jsx)("span",{className:"inline-flex items-center px-3 py-1 rounded-full text-xs bg-green-900/30 text-green-400",children:"âš¡ Instant"})]}),(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)("h5",{className:"text-slate-300 font-medium mb-2",children:"Detailed Support"}),(0,s.jsx)("p",{className:"text-slate-500 text-sm mb-3",children:"Use the contact form below"}),(0,s.jsx)("span",{className:"inline-flex items-center px-3 py-1 rounded-full text-xs bg-blue-900/30 text-blue-400",children:"ðŸ“‹ Structured"})]})]}),(0,s.jsx)("div",{className:"text-center",children:(0,s.jsxs)("p",{className:"text-slate-500 text-sm mb-4",children:["Or email us directly at"," ",(0,s.jsx)("a",{href:"mailto:spendflowapp@gmail.com",className:"text-amber-400 hover:text-amber-300 transition-colors",children:"spendflowapp@gmail.com"})]})}),(0,s.jsx)("div",{className:"text-center",children:(0,s.jsx)("p",{className:"text-slate-600 text-xs",children:"ðŸ’¡ Tip: For quick questions, use Messages. For detailed inquiries, use the contact form."})})]}),(0,s.jsx)(Z,{isOpen:p,onClose:()=>!y&&g(!1),onSubmit:M,isSending:y,formData:j,formErrors:S,onFormChange:e=>{let{name:s,value:t}=e.target;f(e=>({...e,[s]:t})),S[s]&&k(e=>({...e,[s]:void 0}))}})]})})}):null}let es=(0,k.default)("monitor",[["rect",{width:"20",height:"14",x:"2",y:"3",rx:"2",key:"48i651"}],["line",{x1:"8",x2:"16",y1:"21",y2:"21",key:"1svkeh"}],["line",{x1:"12",x2:"12",y1:"17",y2:"21",key:"vw1qmm"}]]),et=(0,k.default)("smartphone",[["rect",{width:"14",height:"20",x:"5",y:"2",rx:"2",ry:"2",key:"1yt0o3"}],["path",{d:"M12 18h.01",key:"mhygvu"}]]);var ea=e.i(87432);function er(){let{user:e}=(0,t.useAuth)(),[a,r]=(0,u.useState)([]),[i,n]=(0,u.useState)(!0),[d,c]=(0,u.useState)(null);(0,u.useEffect)(()=>{e&&(o(),m())},[e]);let o=async()=>{if(e)try{let s=await ea.DeviceManagementService.getTrustedDevices(e.uid);r(s)}catch(e){console.error("Error loading devices:",e),D.default.error("Failed to load devices")}finally{n(!1)}},m=async()=>{try{let e=await ea.DeviceManagementService.generateDeviceFingerprint(),s=await ea.DeviceManagementService.generateDeviceId(e);c(s)}catch(e){console.error("Error getting current device ID:",e)}},x=async e=>{if(confirm("Are you sure you want to revoke trust for this device? You will need to verify your identity the next time you log in from this device."))try{await ea.DeviceManagementService.revokeDeviceTrust(e),await o(),D.default.success("Device trust revoked")}catch(e){console.error("Error revoking device trust:",e),D.default.error("Failed to revoke device trust")}};return i?(0,s.jsx)("div",{className:"bg-slate-900/50 border border-slate-800 rounded-lg p-6",children:(0,s.jsxs)("div",{className:"flex items-center justify-center py-8",children:[(0,s.jsx)("div",{className:"animate-spin rounded-full h-6 w-6 border-2 border-amber-400 border-t-transparent"}),(0,s.jsx)("span",{className:"ml-3 text-slate-400",children:"Loading devices..."})]})}):(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[(0,s.jsx)(l.Shield,{className:"h-6 w-6 text-amber-400"}),(0,s.jsxs)("div",{children:[(0,s.jsx)("h2",{className:"text-2xl font-serif text-slate-100",children:"Device Management"}),(0,s.jsx)("p",{className:"text-slate-400 text-sm",children:"Manage trusted devices and login sessions"})]})]}),(0,s.jsx)("div",{className:"bg-blue-900/20 border border-blue-700/50 rounded-lg p-4",children:(0,s.jsxs)("div",{className:"flex items-start gap-3",children:[(0,s.jsx)(l.Shield,{className:"h-5 w-5 text-blue-400 mt-0.5"}),(0,s.jsxs)("div",{children:[(0,s.jsx)("h3",{className:"text-blue-400 font-medium mb-1",children:"Security Information"}),(0,s.jsx)("p",{className:"text-blue-300 text-sm",children:"Trusted devices allow you to stay logged in longer without re-authentication. Revoking trust will require you to verify your identity on the next login from that device."})]})]})}),(0,s.jsx)("div",{className:"bg-slate-900/50 border border-slate-800 rounded-lg overflow-hidden",children:0===a.length?(0,s.jsxs)("div",{className:"text-center py-12",children:[(0,s.jsx)(es,{className:"h-12 w-12 text-slate-600 mx-auto mb-2"}),(0,s.jsx)("p",{className:"text-sm text-slate-400",children:"No devices found"}),(0,s.jsx)("p",{className:"text-xs text-slate-500 mt-1",children:"Devices will appear here as you log in"})]}):(0,s.jsx)("div",{className:"divide-y divide-slate-800",children:a.map(e=>{let t,a;return(0,s.jsx)("div",{className:"p-6",children:(0,s.jsxs)("div",{className:"flex items-start justify-between",children:[(0,s.jsxs)("div",{className:"flex items-start space-x-4 flex-1",children:[(0,s.jsx)("div",{className:"p-2 bg-slate-800 rounded-lg",children:(t=e.fingerprint.userAgent.toLowerCase()).includes("mobile")||t.includes("android")||t.includes("iphone")?(0,s.jsx)(et,{className:"h-5 w-5 text-blue-400"}):(0,s.jsx)(es,{className:"h-5 w-5 text-purple-400"})}),(0,s.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,s.jsxs)("div",{className:"flex items-center gap-3 mb-2",children:[(0,s.jsx)("h3",{className:"text-lg font-medium text-slate-100 truncate",children:e.deviceName}),e.deviceId===d?(0,s.jsxs)("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-green-900/30 text-green-400",children:[(0,s.jsx)(g.CheckCircle,{className:"h-3 w-3 mr-1"}),"Current Device"]}):e.isTrusted?(0,s.jsxs)("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-blue-900/30 text-blue-400",children:[(0,s.jsx)(l.Shield,{className:"h-3 w-3 mr-1"}),"Trusted"]}):(0,s.jsxs)("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-gray-900/30 text-gray-400",children:[(0,s.jsx)(p.AlertTriangle,{className:"h-3 w-3 mr-1"}),"Not Trusted"]})]}),(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-2 text-sm text-slate-400 mb-3",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("span",{className:"font-medium",children:"Type:"})," ",(a=e.fingerprint.userAgent.toLowerCase()).includes("mobile")||a.includes("android")||a.includes("iphone")?"Mobile":"Desktop"]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("span",{className:"font-medium",children:"Platform:"})," ",e.fingerprint.platform]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("span",{className:"font-medium",children:"Browser:"})," ",e.fingerprint.userAgent.split(" ").slice(-2,-1)[0]||"Unknown"]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("span",{className:"font-medium",children:"Last Login:"})," ",(e=>{if(!e)return"Never";let s=e?.toDate?.()||new Date(e),t=(new Date().getTime()-s.getTime())/36e5;return t<1?"Just now":t<24?`${Math.floor(t)}h ago`:t<168?`${Math.floor(t/24)}d ago`:s.toLocaleDateString()})(e.lastLogin)]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("span",{className:"font-medium",children:"Login Count:"})," ",e.loginCount]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("span",{className:"font-medium",children:"Security:"})," ",e.securityLevel.charAt(0).toUpperCase()+e.securityLevel.slice(1)]})]}),e.ipAddress&&(0,s.jsxs)("div",{className:"text-xs text-slate-500 mb-2",children:[(0,s.jsx)("span",{className:"font-medium",children:"IP Address:"})," ",e.ipAddress]}),e.location&&(0,s.jsxs)("div",{className:"text-xs text-slate-500",children:[(0,s.jsx)("span",{className:"font-medium",children:"Location:"})," ",e.location.city,", ",e.location.country]})]})]}),(0,s.jsxs)("div",{className:"flex items-center gap-2 ml-4",children:[e.deviceId!==d&&e.isTrusted&&(0,s.jsxs)("button",{onClick:()=>x(e.id),className:"px-3 py-1 text-xs bg-red-600 hover:bg-red-700 text-white rounded-md transition-colors flex items-center gap-1",title:"Revoke trust for this device",children:[(0,s.jsx)(j.XCircle,{className:"h-3 w-3"}),"Revoke Trust"]}),e.deviceId===d&&(0,s.jsxs)("div",{className:"px-3 py-1 text-xs bg-green-900/30 text-green-400 rounded-md flex items-center gap-1",children:[(0,s.jsx)(g.CheckCircle,{className:"h-3 w-3"}),"Current"]})]})]})},e.id)})})}),a.length>0&&(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,s.jsx)("div",{className:"bg-slate-900/50 border border-slate-800 rounded-lg p-4",children:(0,s.jsxs)("div",{className:"flex items-center",children:[(0,s.jsx)(l.Shield,{className:"h-8 w-8 text-green-500 mr-3"}),(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-2xl font-bold text-slate-100",children:a.filter(e=>e.isTrusted).length}),(0,s.jsx)("p",{className:"text-sm text-slate-400",children:"Trusted Devices"})]})]})}),(0,s.jsx)("div",{className:"bg-slate-900/50 border border-slate-800 rounded-lg p-4",children:(0,s.jsxs)("div",{className:"flex items-center",children:[(0,s.jsx)(es,{className:"h-8 w-8 text-blue-500 mr-3"}),(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-2xl font-bold text-slate-100",children:a.filter(e=>e.fingerprint.userAgent.toLowerCase().includes("mobile")).length}),(0,s.jsx)("p",{className:"text-sm text-slate-400",children:"Mobile Devices"})]})]})}),(0,s.jsx)("div",{className:"bg-slate-900/50 border border-slate-800 rounded-lg p-4",children:(0,s.jsxs)("div",{className:"flex items-center",children:[(0,s.jsx)(p.AlertTriangle,{className:"h-8 w-8 text-amber-500 mr-3"}),(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-2xl font-bold text-slate-100",children:a.filter(e=>!e.isTrusted).length}),(0,s.jsx)("p",{className:"text-sm text-slate-400",children:"Untrusted Devices"})]})]})})]})]})}e.i(32234);var el=e.i(98466);function ei(){let{user:e}=(0,t.useAuth)(),{theme:m}=(0,x.useSubscription)(),[h,b]=(0,u.useState)(!1),[p,g]=(0,u.useState)(0),[j,f]=(0,u.useState)(!1),[y,w]=(0,u.useState)(""),[k,C]=(0,u.useState)(!1);(0,u.useEffect)(()=>{h&&D.default.success("ðŸ’¬ Support & Messages opened! Send us your questions or feedback.",{duration:4e3,position:"top-right",style:{background:"#1e293b",color:"#f1f5f9",border:"1px solid #f59e0b"},icon:"ðŸ“¨"})},[h]),(0,u.useEffect)(()=>{let e=()=>{document.hidden||g(e=>e+1)};return document.addEventListener("visibilitychange",e),()=>document.removeEventListener("visibilitychange",e)},[]);let A=async()=>{if(e&&y.trim()){C(!0);try{await (0,el.updateProfile)(e,{displayName:y.trim()});let s=(0,v.doc)(N.db,"users",e.uid);await (0,v.updateDoc)(s,{displayName:y.trim(),updatedAt:new Date().toISOString()}),f(!1),D.default.success("Name updated successfully!")}catch(e){console.error("Error updating name:",e),D.default.error("Failed to update name. Please try again.")}finally{C(!1)}}};return(0,s.jsxs)("div",{className:"w-full px-4 sm:px-6 md:px-8 lg:px-12 xl:px-16 2xl:px-20 mx-auto space-y-6 sm:space-y-8 md:space-y-10 lg:space-y-12",children:[(0,s.jsxs)("div",{className:"text-center px-2 sm:px-4",children:[(0,s.jsx)("div",{className:"w-8 sm:w-12 md:w-16 h-0.5 bg-linear-to-r from-transparent via-amber-400 to-transparent mx-auto mb-3 sm:mb-4 md:mb-8"}),(0,s.jsx)("h1",{className:"text-xl sm:text-2xl md:text-3xl lg:text-4xl xl:text-5xl font-serif text-slate-100 mb-2 sm:mb-4 tracking-wide",children:"P R O F I L E"}),(0,s.jsx)("div",{className:"w-12 sm:w-16 md:w-24 h-0.5 bg-linear-to-r from-transparent via-amber-400 to-transparent mx-auto mb-3 sm:mb-4 md:mb-6"}),(0,s.jsx)("p",{className:"text-slate-400 text-xs sm:text-sm tracking-widest uppercase",children:"Account Information"})]}),(0,s.jsx)("div",{className:"max-w-4xl mx-auto",children:(0,s.jsxs)("div",{className:"bg-linear-to-br from-amber-900/20 via-slate-900/50 to-slate-900/20 border border-amber-700/30 rounded-lg p-6 sm:p-8 md:p-10 lg:p-12 backdrop-blur-sm",children:[(0,s.jsxs)("div",{className:"text-center mb-8 sm:mb-10 md:mb-12",children:[(0,s.jsx)("div",{className:"w-16 sm:w-20 md:w-24 h-16 sm:h-20 md:h-24 bg-slate-800 rounded-full mx-auto mb-4 sm:mb-6 flex items-center justify-center border-2 border-amber-600",children:(0,s.jsx)(a.User,{className:"h-8 sm:h-10 md:h-12 w-8 sm:w-10 md:w-12 text-amber-400"})}),j?(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsx)("div",{className:"flex items-center justify-center gap-3",children:(0,s.jsx)("input",{type:"text",value:y,onChange:e=>w(e.target.value),className:"text-xl sm:text-2xl md:text-3xl font-serif text-slate-100 bg-slate-800/50 border border-amber-600 rounded px-3 py-1 text-center focus:outline-none focus:ring-2 focus:ring-amber-500",placeholder:"Enter your name",disabled:k})}),(0,s.jsxs)("div",{className:"flex items-center justify-center gap-2",children:[(0,s.jsxs)("button",{onClick:A,disabled:k||!y.trim(),className:"flex items-center gap-2 px-4 py-2 bg-amber-600 hover:bg-amber-700 text-white rounded-md transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:[(0,s.jsx)(c.Check,{className:"h-4 w-4"}),k?"Saving...":"Save"]}),(0,s.jsxs)("button",{onClick:()=>{f(!1),w("")},disabled:k,className:"flex items-center gap-2 px-4 py-2 bg-slate-600 hover:bg-slate-700 text-white rounded-md transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:[(0,s.jsx)(o.X,{className:"h-4 w-4"}),"Cancel"]})]})]}):(0,s.jsxs)("div",{className:"flex items-center justify-center gap-3 mb-2",children:[(0,s.jsx)("h2",{className:"text-xl sm:text-2xl md:text-3xl font-serif text-slate-100",children:e?.displayName||"User"}),(0,s.jsx)("button",{onClick:()=>{w(e?.displayName||""),f(!0)},className:"p-1 text-amber-400 hover:text-amber-300 transition-colors",title:"Edit name",children:(0,s.jsx)(d.Edit2,{className:"h-5 w-5"})})]}),(0,s.jsx)("div",{className:"text-slate-500 text-sm sm:text-base tracking-wider",children:e?.email})]}),(0,s.jsxs)("div",{className:"space-y-4 sm:space-y-6",children:[(0,s.jsx)("div",{className:"border border-slate-800 bg-slate-900/50 p-4 sm:p-6 rounded-lg",children:(0,s.jsxs)("div",{className:"border-l-2 border-amber-600 pl-3 sm:pl-4 md:pl-6",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2 sm:gap-3 mb-2 sm:mb-3",children:[(0,s.jsx)(r.Mail,{className:"h-4 w-4 sm:h-5 sm:w-5 text-amber-400"}),(0,s.jsx)("div",{className:"text-slate-500 text-xs tracking-widest uppercase font-serif",children:"Email"})]}),(0,s.jsx)("div",{className:"text-base sm:text-lg font-serif text-slate-100",children:e?.email})]})}),(0,s.jsx)("div",{className:"border border-slate-800 bg-slate-900/50 p-4 sm:p-6 rounded-lg",children:(0,s.jsxs)("div",{className:"border-l-2 border-amber-600 pl-3 sm:pl-4 md:pl-6",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2 sm:gap-3 mb-2 sm:mb-3",children:[(0,s.jsx)(l.Shield,{className:"h-4 w-4 sm:h-5 sm:w-5 text-amber-400"}),(0,s.jsx)("div",{className:"text-slate-500 text-xs tracking-widest uppercase font-serif",children:"Account Status"})]}),(0,s.jsxs)("div",{className:"text-base sm:text-lg font-serif text-slate-100",children:[m.name," Plan"]})]})}),(0,s.jsx)("div",{className:"border border-slate-800 bg-slate-900/50 p-4 sm:p-6 rounded-lg",children:(0,s.jsxs)("div",{className:"border-l-2 border-amber-600 pl-3 sm:pl-4 md:pl-6",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2 sm:gap-3 mb-2 sm:mb-3",children:[(0,s.jsx)(i.Calendar,{className:"h-4 w-4 sm:h-5 sm:w-5 text-amber-400"}),(0,s.jsx)("div",{className:"text-slate-500 text-xs tracking-widest uppercase font-serif",children:"Member Since"})]}),(0,s.jsx)("div",{className:"text-base sm:text-lg font-serif text-slate-100",children:e?.metadata?.creationTime?new Date(e.metadata.creationTime).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"}):"N/A"})]})})]})]})}),(0,s.jsx)("div",{className:"max-w-4xl mx-auto",children:(0,s.jsx)(S,{})}),(0,s.jsx)("div",{className:"max-w-4xl mx-auto",children:(0,s.jsx)(er,{})}),(0,s.jsx)("div",{className:"max-w-4xl mx-auto",children:(0,s.jsx)(F,{})}),(0,s.jsx)("div",{className:"max-w-4xl mx-auto",children:(0,s.jsx)(O,{},p)}),(0,s.jsx)("div",{className:"max-w-4xl mx-auto",children:(0,s.jsx)(G,{})}),(0,s.jsx)("div",{className:"max-w-4xl mx-auto",children:(0,s.jsx)("div",{className:"bg-linear-to-br from-amber-900/20 via-slate-900/50 to-slate-900/20 border border-amber-700/30 rounded-lg p-6 sm:p-8 md:p-10 lg:p-12 backdrop-blur-sm",children:(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)(n.MessageSquare,{className:"h-12 sm:h-16 md:h-20 w-12 sm:w-16 md:w-20 text-amber-400 mx-auto mb-4 sm:mb-6"}),(0,s.jsx)("h3",{className:"text-xl sm:text-2xl md:text-3xl font-serif text-slate-100 mb-2 sm:mb-4",children:"Support & Messages"}),(0,s.jsx)("p",{className:"text-slate-400 text-sm sm:text-base mb-6 sm:mb-8 max-w-2xl mx-auto",children:"Need help? Send us a message or contact our support team. We're here to assist you with any questions or issues."}),(0,s.jsxs)("button",{onClick:()=>b(!0),className:"group relative px-6 sm:px-8 py-3 sm:py-4 bg-amber-600 hover:bg-amber-700 text-white font-medium rounded-md transition-all duration-300 flex items-center gap-2 mx-auto shadow-lg hover:shadow-xl hover:scale-105",children:[(0,s.jsx)("div",{className:"absolute inset-0 rounded-md bg-amber-500 animate-ping opacity-20"}),(0,s.jsxs)("div",{className:"relative flex items-center gap-2",children:[(0,s.jsx)(n.MessageSquare,{className:"h-5 w-5 group-hover:animate-bounce"}),(0,s.jsx)("span",{children:"Open Support & Messages"}),(0,s.jsx)("div",{className:"ml-2 flex items-center",children:(0,s.jsxs)("div",{className:"relative",children:[(0,s.jsx)("div",{className:"w-2 h-2 bg-green-400 rounded-full animate-pulse"}),(0,s.jsx)("div",{className:"absolute inset-0 w-2 h-2 bg-green-400 rounded-full animate-ping opacity-75"})]})})]})]})]})})}),(0,s.jsxs)("div",{className:"text-center pt-6 sm:pt-8 md:pt-12 border-t border-slate-800 px-2 sm:px-4",children:[(0,s.jsx)("div",{className:"text-amber-400/40 text-4xl sm:text-5xl md:text-6xl mb-3 sm:mb-4",children:'"'}),(0,s.jsx)("p",{className:"text-slate-400 text-base sm:text-lg font-serif italic mb-3 sm:mb-4 max-w-2xl mx-auto",children:"Your financial journey is unique. Make it extraordinary."}),(0,s.jsx)("div",{className:"text-slate-600 text-sm tracking-widest",children:"â€” SPENDFLOW"})]}),(0,s.jsx)(ee,{isOpen:h,onClose:()=>b(!1)})]})}function en(){return(0,s.jsx)(m.AuthGate,{children:(0,s.jsx)(ei,{})})}e.s(["default",()=>en],29789)}]);