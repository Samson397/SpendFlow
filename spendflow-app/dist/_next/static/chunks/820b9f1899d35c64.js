(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,43553,e=>{"use strict";let t=(0,e.i(75254).default)("crown",[["path",{d:"M11.562 3.266a.5.5 0 0 1 .876 0L15.39 8.87a1 1 0 0 0 1.516.294L21.183 5.5a.5.5 0 0 1 .798.519l-2.834 10.246a1 1 0 0 1-.956.734H5.81a1 1 0 0 1-.957-.734L2.02 6.02a.5.5 0 0 1 .798-.519l4.276 3.664a1 1 0 0 0 1.516-.294z",key:"1vdc57"}],["path",{d:"M5 21h14",key:"11awu3"}]]);e.s(["Crown",()=>t],43553)},44025,e=>{"use strict";let t=(0,e.i(75254).default)("award",[["path",{d:"m15.477 12.89 1.515 8.526a.5.5 0 0 1-.81.47l-3.58-2.687a1 1 0 0 0-1.197 0l-3.586 2.686a.5.5 0 0 1-.81-.469l1.514-8.526",key:"1yiouv"}],["circle",{cx:"12",cy:"8",r:"6",key:"1vp47v"}]]);e.s(["Award",()=>t],44025)},85451,e=>{"use strict";function t(e){if(!e||!e.includes("/"))return{isExpired:!1,isExpiringSoon:!1,daysUntilExpiry:1/0};let[t,a]=e.split("/").map(e=>parseInt(e,10));if(isNaN(t)||isNaN(a)||t<1||t>12)return{isExpired:!1,isExpiringSoon:!1,daysUntilExpiry:1/0};let s=new Date(a<50?2e3+a:1900+a,t-1);s.setMonth(s.getMonth()+1,0),s.setHours(23,59,59,999);let r=new Date,l=Math.ceil((s.getTime()-r.getTime())/864e5),n=l<0;return{isExpired:n,isExpiringSoon:!n&&l<=30,daysUntilExpiry:l}}e.s(["getCardExpiryStatus",()=>t])},61659,e=>{"use strict";let t=(0,e.i(75254).default)("credit-card",[["rect",{width:"20",height:"14",x:"2",y:"5",rx:"2",key:"ynyp8z"}],["line",{x1:"2",x2:"22",y1:"10",y2:"10",key:"1b3vmo"}]]);e.s(["CreditCard",()=>t],61659)},84099,e=>{"use strict";var t=e.i(52621),a=e.i(82078),s=e.i(20976),r=e.i(2188),l=e.i(31278);function n({children:e,requireAuth:n=!0}){let{user:i,loading:c}=(0,r.useAuth)(),o=(0,s.useRouter)();return((0,a.useEffect)(()=>{c||(n&&!i?o.push("/login"):!n&&i&&o.push("/dashboard"))},[i,c,n,o]),c)?(0,t.jsx)("div",{className:"min-h-screen bg-slate-950 flex items-center justify-center",children:(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)(l.Loader2,{className:"h-12 w-12 text-amber-400 animate-spin mx-auto mb-4"}),(0,t.jsx)("p",{className:"text-slate-400 text-sm",children:"Loading..."})]})}):n&&!i||!n&&i?null:(0,t.jsx)(t.Fragment,{children:e})}e.s(["AuthGate",()=>n])},7233,e=>{"use strict";let t=(0,e.i(75254).default)("plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);e.s(["Plus",()=>t],7233)},73755,e=>{"use strict";e.i(52621),e.i(82078);var t=e.i(69834),a=e.i(2188),s=e.i(65131);class r{static instance;constructor(){}static getInstance(){return r.instance||(r.instance=new r),r.instance}async checkFeatureAccess(e,a,s={}){try{if(await this.isUserAdmin(e))return{allowed:!0,reason:"Admin access - no limits applied",currentUsage:s.currentCount,limit:-1};let r=await t.subscriptionService.getUserLimits(e);if(!r[a])return{allowed:!1,reason:"This feature is not available on your current plan",upgradeRequired:!0};if(void 0!==s.currentCount&&"number"==typeof r[a]){let e=r[a];if(-1===e||s.currentCount<e)return{allowed:!0,currentUsage:s.currentCount,limit:-1===e?void 0:e};return{allowed:!1,reason:`You've reached your plan limit of ${e} ${a}`,upgradeRequired:!0,currentUsage:s.currentCount,limit:e}}return{allowed:!0}}catch(e){return console.error("Error checking feature access:",e),{allowed:!0,reason:"Unable to verify access, proceeding..."}}}async canAddCard(e){let t=await this.getCurrentCardCount(e);return this.checkFeatureAccess(e,"maxCards",{currentCount:t})}async canAddTransaction(e){let t=await this.getCurrentTransactionCount(e);return this.checkFeatureAccess(e,"maxTransactions",{currentCount:t})}async canExportData(e){return this.checkFeatureAccess(e,"export")}async canAccessAnalytics(e){return this.checkFeatureAccess(e,"analytics")}async canAccessAPI(e){return this.checkFeatureAccess(e,"apiAccess")}async hasPrioritySupport(e){return(await this.checkFeatureAccess(e,"prioritySupport")).allowed}async getUserLimits(e){return t.subscriptionService.getUserLimits(e)}async getUserPlanInfo(e){let a=await t.subscriptionService.getUserSubscription(e);if(!a)return null;let s=await t.subscriptionService.getPlan(a.planId);return{subscription:a,plan:s}}async isUserAdmin(t){try{let{usersService:a}=await e.A(76860),s=await a.get(t);if(s?.email&&("spendflowapp@gmail.com".split(",")||[]).includes(s.email))return!0;return s?.isAdmin===!0}catch(e){return console.error("Error checking admin status:",e),!1}}async getCurrentCardCount(t){try{let{cardsService:a}=await e.A(76860);return(await a.getByUserId(t)).length}catch(e){return console.error("Error getting card count:",e),0}}async getCurrentTransactionCount(t){try{let{transactionsService:a}=await e.A(76860);return(await a.getByUserId(t)).length}catch(e){return console.error("Error getting transaction count:",e),0}}}function l(){let{user:e}=(0,a.useAuth)(),{canAccessFeature:t}=(0,s.useSubscription)();return{checkFeatureAccess:async(t,a={})=>e?e.email&&("spendflowapp@gmail.com".split(",")||[]).includes(e.email)?{allowed:!0,reason:"Admin access - no limits applied",currentUsage:a.currentCount,limit:-1}:n.checkFeatureAccess(e.uid,t,a):{allowed:!1,reason:"User not authenticated"},canAddCard:async()=>e?e.email&&("spendflowapp@gmail.com".split(",")||[]).includes(e.email)?{allowed:!0,reason:"Admin access - no limits applied",limit:-1}:n.canAddCard(e.uid):{allowed:!1,reason:"User not authenticated"},canAddTransaction:async()=>e?e.email&&("spendflowapp@gmail.com".split(",")||[]).includes(e.email)?{allowed:!0,reason:"Admin access - no limits applied",limit:-1}:n.canAddTransaction(e.uid):{allowed:!1,reason:"User not authenticated"},canExportData:async()=>e?n.canExportData(e.uid):{allowed:!1,reason:"User not authenticated"},canAccessAnalytics:async()=>e?n.canAccessAnalytics(e.uid):{allowed:!1,reason:"User not authenticated"},canAccessAPI:async()=>e?n.canAccessAPI(e.uid):{allowed:!1,reason:"User not authenticated"},hasPrioritySupport:async()=>!!e&&n.hasPrioritySupport(e.uid),canAccessFeature:t}}let n=r.getInstance();e.s(["accessControlService",0,n,"useAccessControl",()=>l])},15287,e=>{"use strict";e.i(75271);var t=e.i(5158),a=e.i(41195);class s{static instance;categoriesRef=(0,t.collection)(a.db,"categories");constructor(){}static getInstance(){return s.instance||(s.instance=new s),s.instance}async getUserCategories(e){try{let a=(0,t.query)(this.categoriesRef,(0,t.where)("userId","==",e)),s=await (0,t.getDocs)(a),r=[];return s.forEach(e=>{let t=e.data();r.push({id:e.id,name:t.name,color:t.color,icon:t.icon,type:t.type})}),r}catch(e){return console.error("Error getting user categories:",e),[]}}async createCategory(e,a){try{return(await (0,t.addDoc)(this.categoriesRef,{...a,userId:e,createdAt:t.Timestamp.now(),updatedAt:t.Timestamp.now()})).id}catch(e){throw console.error("Error creating category:",e),Error("Failed to create category")}}async updateCategory(e,a){try{let s=(0,t.doc)(this.categoriesRef,e);await (0,t.updateDoc)(s,{...a,updatedAt:t.Timestamp.now()})}catch(e){throw console.error("Error updating category:",e),Error("Failed to update category")}}async deleteCategory(e){try{let a=(0,t.doc)(this.categoriesRef,e);await (0,t.deleteDoc)(a)}catch(e){throw console.error("Error deleting category:",e),Error("Failed to delete category")}}getDefaultCategories(e){return({income:[{name:"Salary",color:"#10b981",icon:"ðŸ’¼",type:"income"},{name:"Freelance",color:"#3b82f6",icon:"ðŸ’»",type:"income"},{name:"Investment",color:"#8b5cf6",icon:"ðŸ“ˆ",type:"income"},{name:"Gift",color:"#f59e0b",icon:"ðŸŽ",type:"income"},{name:"Other",color:"#6b7280",icon:"ðŸ’°",type:"income"}],expense:[{name:"Food",color:"#ef4444",icon:"ðŸ½ï¸",type:"expense"},{name:"Transport",color:"#f97316",icon:"ðŸš—",type:"expense"},{name:"Shopping",color:"#ec4899",icon:"ðŸ›ï¸",type:"expense"},{name:"Bills",color:"#6366f1",icon:"ðŸ“„",type:"expense"},{name:"Entertainment",color:"#8b5cf6",icon:"ðŸŽ¬",type:"expense"},{name:"Healthcare",color:"#06b6d4",icon:"ðŸ¥",type:"expense"},{name:"Other",color:"#6b7280",icon:"ðŸ“¦",type:"expense"}]})[e]||[]}async getAllCategories(e,t){let a=await this.getUserCategories(e),s=this.getDefaultCategories(t||"expense"),r=t?a.filter(e=>e.type===t):a,l=s.map(e=>({id:"",...e}));return r.forEach(e=>{let t=l.findIndex(t=>t.name===e.name&&t.type===e.type);t>=0?l[t]=e:l.push(e)}),l}}let r=s.getInstance();e.s(["categoryService",0,r])},35408,e=>{"use strict";let t=(0,e.i(75254).default)("trending-down",[["path",{d:"M16 17h6v-6",key:"t6n2it"}],["path",{d:"m22 17-8.5-8.5-5 5L2 7",key:"x473p"}]]);e.s(["TrendingDown",()=>t],35408)},77529,e=>{"use strict";let t=(0,e.i(75254).default)("circle-check-big",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);e.s(["CheckCircle",()=>t],77529)},25652,e=>{"use strict";let t=(0,e.i(75254).default)("trending-up",[["path",{d:"M16 7h6v6",key:"box55l"}],["path",{d:"m22 7-8.5 8.5-5-5L2 17",key:"1t1m79"}]]);e.s(["TrendingUp",()=>t],25652)},71589,e=>{"use strict";var t=e.i(52621),a=e.i(82078),s=e.i(37727),r=e.i(25652),l=e.i(35408),n=e.i(75254);let i=(0,n.default)("camera",[["path",{d:"M13.997 4a2 2 0 0 1 1.76 1.05l.486.9A2 2 0 0 0 18.003 7H20a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V9a2 2 0 0 1 2-2h1.997a2 2 0 0 0 1.759-1.048l.489-.904A2 2 0 0 1 10.004 4z",key:"18u6gg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]]);var c=e.i(30945),o=e.i(15287),d=e.i(2188),m=e.i(38957);let x=(0,n.default)("upload",[["path",{d:"M12 3v12",key:"1x0j5s"}],["path",{d:"m17 8-5-5-5 5",key:"7q97r8"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}]]);var u=e.i(31278),p=e.i(77529);let h={async scanReceipt(e){try{let t=await this.fileToBase64(e),a=await this.extractTextFromImage(t),s=this.parseReceiptText(a);return s.category=this.detectCategory(a,s.merchant),s}catch(e){throw console.error("Error scanning receipt:",e),Error("Failed to scan receipt")}},fileToBase64:e=>new Promise((t,a)=>{let s=new FileReader;s.onload=()=>t(s.result),s.onerror=a,s.readAsDataURL(e)}),async extractTextFromImage(t){try{console.log("Loading Tesseract.js...");let a=await e.A(94307);console.log("Tesseract.js loaded successfully");let s=await a.recognize(t,"eng",{logger:e=>{"recognizing text"===e.status&&console.log(`OCR Progress: ${Math.round(100*e.progress)}%`)}});return console.log("OCR completed successfully"),s.data.text}catch(e){if(console.error("OCR Error:",e),e instanceof Error){if(e.message.includes("permission")||e.message.includes("denied"))throw console.warn("OCR permission error detected"),Error("Camera or file access permission denied. Please check your browser permissions.");if(e.message.includes("network")||e.message.includes("fetch"))throw console.warn("OCR network error detected"),Error("Network error while loading OCR. Please check your connection.")}return console.log("OCR failed, using fallback"),""}},parseReceiptText(e){let t={rawText:e};for(let a of[/\$?\s*(\d+\.\d{2})\s*(?:total|amount|sum|balance)/i,/(?:total|amount|sum|balance)\s*:?\s*\$?\s*(\d+\.\d{2})/i,/\$\s*(\d+\.\d{2})/g]){let s=e.match(a);if(s){let e=parseFloat(s[1]||s[0].replace(/[^0-9.]/g,""));if(!isNaN(e)&&e>0){t.amount=e;break}}}for(let a of[/(\d{1,2}[-/]\d{1,2}[-/]\d{2,4})/,/(\d{4}[-/]\d{1,2}[-/]\d{1,2})/,/(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)\s+\d{1,2},?\s+\d{4}/i,/(\d{1,2})\s+(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)\s+(\d{4})/i]){let s=e.match(a);if(s){let e=this.parseDate(s[0]);if(e){t.date=e;break}}}let a=e.split("\n").filter(e=>e.trim().length>0);return a.length>0&&(t.merchant=a[0].trim()),t},validateReceiptData(e){let t=[];return(!e.amount||e.amount<=0)&&t.push("Could not detect a valid amount"),(!e.merchant||e.merchant.length<2)&&t.push("Could not detect merchant name"),{valid:0===t.length,errors:t}},parseDate(e){try{let t=new Date(e);if(isNaN(t.getTime()))return null;let a=t.getFullYear(),s=String(t.getMonth()+1).padStart(2,"0"),r=String(t.getDate()).padStart(2,"0");return`${a}-${s}-${r}`}catch(e){return null}},detectCategory(e,t){let a=e.toLowerCase(),s=(t||"").toLowerCase(),r=`${a} ${s}`;for(let[e,t]of Object.entries({Transport:["petrol","gas","fuel","shell","bp","esso","texaco","chevron","uber","lyft","taxi","parking"],Groceries:["grocery","supermarket","tesco","sainsbury","asda","waitrose","aldi","lidl","milk","bread","food mart","market"],Dining:["restaurant","cafe","coffee","starbucks","mcdonald","burger","pizza","kfc","subway","dining","bistro","grill"],Shopping:["store","shop","retail","amazon","ebay","clothing","fashion","nike","adidas","zara","h&m"],Entertainment:["cinema","movie","theater","netflix","spotify","game","entertainment","ticket"],Healthcare:["pharmacy","medical","doctor","hospital","clinic","health","boots","cvs","walgreens"],Utilities:["electric","water","gas bill","internet","phone bill","utility"],Other:[]}))for(let a of t)if(r.includes(a))return e;return"Other"}};function g({isOpen:e,onClose:r,onDataExtracted:l}){let[n,i]=(0,a.useState)(!1),[c,o]=(0,a.useState)(null),[d,m]=(0,a.useState)(null),[g,b]=(0,a.useState)(""),f=(0,a.useRef)(null),y=async e=>{if(console.log("handleFileSelect called with file:",e.name,e.type,"size:",e.size),e.size>0xa00000)return void b("File size too large. Please select a file smaller than 10MB.");if(!e.type.startsWith("image/"))return void b("Please select an image file (JPG, PNG, etc.)");try{i(!0),b(""),console.log("Starting scan...");let t=new FileReader;t.onload=e=>{console.log("Preview loaded successfully"),o(e.target?.result)},t.onerror=e=>{console.error("FileReader error:",e),b("Failed to read file. Please try again."),i(!1)},t.readAsDataURL(e);let a=h.scanReceipt(e),s=new Promise((e,t)=>setTimeout(()=>t(Error("Scan timeout")),3e4)),r=await Promise.race([a,s]);console.log("Scan complete, data:",r);let l={...r};l.date||(l.date=new Date().toISOString().split("T")[0]),m(l),console.log("Extracted data set:",l)}catch(t){console.error("Receipt scan error:",t);let e=t instanceof Error?t.message:"Unknown error";b(`Failed to scan receipt: ${e}. Please try again or enter manually.`)}finally{i(!1),console.log("Scanning finished")}},v=()=>{o(null),m(null),b(""),i(!1),r()};return e?(0,t.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-60",onClick:v,children:(0,t.jsxs)("div",{className:"bg-slate-950 border border-amber-700/30 rounded-lg shadow-2xl max-w-lg w-full max-h-[90vh] overflow-hidden z-60",onClick:e=>e.stopPropagation(),children:[(0,t.jsx)("input",{ref:f,type:"file",accept:"image/*",className:"hidden",onChange:e=>{console.log("onChange triggered"),e.target.files?.[0]&&(console.log("File from onChange:",e.target.files[0].name),y(e.target.files[0]))},onInput:e=>{console.log("onInput triggered");let t=e.target;t.files?.[0]&&(console.log("File from onInput:",t.files[0].name),y(t.files[0]))}}),(0,t.jsxs)("div",{className:"flex items-center justify-between p-4 border-b border-slate-800",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h2",{className:"text-2xl font-serif text-slate-100 tracking-wide mb-1",children:"SCAN RECEIPT"}),(0,t.jsx)("p",{className:"text-slate-500 text-sm tracking-wider",children:"Take a photo or upload an image"})]}),(0,t.jsx)("button",{onClick:v,className:"text-slate-400 hover:text-slate-200 transition-colors",children:(0,t.jsx)(s.X,{className:"h-6 w-6"})})]}),(0,t.jsxs)("div",{className:"p-4 space-y-4 overflow-y-auto max-h-[calc(90vh-200px)]",children:[!c&&!n&&(0,t.jsx)("div",{className:"space-y-4",children:(0,t.jsxs)("button",{onClick:()=>{f.current&&(f.current.value="",f.current.click())},className:"w-full p-12 border-2 border-dashed border-slate-700 hover:border-amber-600 rounded-lg transition-colors group",children:[(0,t.jsx)(x,{className:"h-20 w-20 mx-auto mb-4 text-slate-600 group-hover:text-amber-400 transition-colors"}),(0,t.jsx)("p",{className:"text-slate-300 font-serif tracking-wider text-lg",children:"Upload Receipt"}),(0,t.jsx)("p",{className:"text-slate-500 text-sm mt-2",children:"Take photo or choose from gallery"}),(0,t.jsx)("p",{className:"text-amber-400/60 text-xs mt-2",children:"ðŸ“± On mobile: Camera option available"})]})}),n&&(0,t.jsxs)("div",{className:"flex flex-col items-center justify-center py-16",children:[(0,t.jsx)(u.Loader2,{className:"h-16 w-16 text-amber-400 animate-spin mb-4"}),(0,t.jsx)("p",{className:"text-slate-300 font-serif tracking-wider text-lg",children:"Scanning receipt..."}),(0,t.jsx)("p",{className:"text-amber-400 text-sm mt-2",children:"Reading text with OCR"}),(0,t.jsx)("p",{className:"text-slate-500 text-xs mt-2",children:"This usually takes 5-10 seconds"}),(0,t.jsx)("div",{className:"mt-4 w-64 bg-slate-800 rounded-full h-1",children:(0,t.jsx)("div",{className:"bg-amber-400 h-1 rounded-full animate-pulse",style:{width:"60%"}})})]}),c&&!n&&(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsx)("div",{className:"relative",children:(0,t.jsx)("img",{src:c,alt:"Receipt preview",className:"w-full rounded-lg border border-slate-700"})}),d&&(0,t.jsxs)("div",{className:"bg-slate-900 border border-slate-700 rounded-lg p-6 space-y-4",children:[(0,t.jsxs)("div",{className:"mb-4",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,t.jsx)(p.CheckCircle,{className:"h-5 w-5 text-green-400"}),(0,t.jsx)("h3",{className:"text-lg font-serif text-slate-100 tracking-wide",children:"Extracted Data"})]}),(0,t.jsx)("p",{className:"text-slate-500 text-xs",children:"Review and edit the automatically extracted information"})]}),(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-slate-500 text-xs uppercase tracking-wider mb-1",children:"Amount"}),(0,t.jsx)("input",{type:"number",step:"0.01",value:d.amount||"",onChange:e=>m({...d,amount:parseFloat(e.target.value)}),className:"w-full px-3 py-2 bg-slate-800 border border-slate-700 text-slate-100 rounded focus:border-amber-600 focus:outline-none"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-slate-500 text-xs uppercase tracking-wider mb-1",children:"Company Name"}),(0,t.jsx)("input",{type:"text",value:d.merchant||"",onChange:e=>m({...d,merchant:e.target.value}),className:"w-full px-3 py-2 bg-slate-800 border border-slate-700 text-slate-100 rounded focus:border-amber-600 focus:outline-none"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-slate-500 text-xs uppercase tracking-wider mb-1",children:"Category"}),(0,t.jsxs)("select",{value:d.category||"Other",onChange:e=>m({...d,category:e.target.value}),className:"w-full px-3 py-2 bg-slate-800 border border-slate-700 text-slate-100 rounded focus:border-amber-600 focus:outline-none",children:[(0,t.jsx)("option",{value:"Transport",children:"Transport"}),(0,t.jsx)("option",{value:"Groceries",children:"Groceries"}),(0,t.jsx)("option",{value:"Dining",children:"Dining"}),(0,t.jsx)("option",{value:"Shopping",children:"Shopping"}),(0,t.jsx)("option",{value:"Entertainment",children:"Entertainment"}),(0,t.jsx)("option",{value:"Healthcare",children:"Healthcare"}),(0,t.jsx)("option",{value:"Utilities",children:"Utilities"}),(0,t.jsx)("option",{value:"Other",children:"Other"})]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-slate-500 text-xs uppercase tracking-wider mb-1",children:"Date"}),(0,t.jsx)("input",{type:"date",value:d.date||"",onChange:e=>m({...d,date:e.target.value}),className:"w-full px-3 py-2 bg-slate-800 border border-slate-700 text-slate-100 rounded focus:border-amber-600 focus:outline-none"})]})]}),(0,t.jsx)("p",{className:"text-slate-500 text-xs mt-4",children:"ðŸ’¡ Tip: OCR may not be 100% accurate - please verify the extracted data"})]}),g&&(0,t.jsx)("div",{className:"bg-red-900/20 border border-red-700/30 rounded-lg p-4",children:(0,t.jsx)("p",{className:"text-red-300 text-sm",children:g})})]})]}),c&&!n&&(0,t.jsxs)("div",{className:"flex gap-4 p-4 border-t border-slate-800",children:[(0,t.jsx)("button",{onClick:v,className:"flex-1 px-6 py-3 border border-slate-700 text-slate-300 hover:bg-slate-800 transition-colors font-serif tracking-wider uppercase",children:"Cancel"}),(0,t.jsx)("button",{onClick:()=>{d&&(l({amount:d.amount||0,merchant:d.merchant||"",date:d.date,category:d.category||"Other"}),v())},disabled:!d?.amount||!d?.merchant,className:"flex-1 px-6 py-3 border border-amber-600 text-amber-400 bg-amber-900/10 hover:bg-amber-600/20 transition-colors font-serif tracking-wider uppercase disabled:opacity-50 disabled:cursor-not-allowed",children:"Use This Data"})]})]})}):null}var b=e.i(85451);let f={income:["Salary","Freelance","Investment","Gift","Other"],expense:["Food","Transport","Shopping","Bills","Entertainment","Healthcare","Other"]};function y({isOpen:e,onClose:n,onSuccess:x,defaultType:u="expense"}){let{user:p}=(0,d.useAuth)(),{currency:h}=(0,m.useCurrency)(),[y,v]=(0,a.useState)(!1),[j,w]=(0,a.useState)(!1),[N,k]=(0,a.useState)([]),[C,A]=(0,a.useState)({income:[],expense:[]}),[S,T]=(0,a.useState)({type:u,amount:"",category:"",description:"",cardId:"",date:new Date().toISOString().split("T")[0]});(0,a.useEffect)(()=>{e&&p&&(I(),D())},[e,p]);let I=async()=>{try{let e=(await c.cardsService.getByUserId(p.uid)).filter(e=>{if(!e.expiryDate)return!0;let{isExpired:t}=(0,b.getCardExpiryStatus)(e.expiryDate);return!t});k(e),e.length>0&&T(t=>({...t,cardId:e[0].id}))}catch(e){console.error("Error loading cards:",e)}},D=async()=>{if(p)try{let e=await o.categoryService.getAllCategories(p.uid),t=e.filter(e=>"income"===e.type).map(e=>e.name),a=e.filter(e=>"expense"===e.type).map(e=>e.name);A({income:t.length>0?t:f.income,expense:a.length>0?a:f.expense})}catch(e){console.error("Error loading categories:",e),A(f)}};if(!e)return null;let E=async e=>{if(e.preventDefault(),!p)return;let t=parseFloat(S.amount);if(!S.amount||isNaN(t)||t<=0)return void alert("Please enter a valid amount greater than 0");if(!S.description.trim())return void alert("Please enter a description or merchant name");if(!S.cardId)return void alert("Please select a card");try{v(!0),await c.transactionsService.create({userId:p.uid,type:S.type,amount:parseFloat(S.amount),category:S.category,description:S.description,cardId:S.cardId,date:new Date(S.date),isRecurring:!1});let e=N.find(e=>e.id===S.cardId);if(e){if("debit"===e.type){let t="income"===S.type?e.balance+parseFloat(S.amount):e.balance-parseFloat(S.amount);await c.cardsService.update(S.cardId,{balance:t})}else if("credit"===e.type){if("expense"===S.type){let t=e.balance-parseFloat(S.amount);await c.cardsService.update(S.cardId,{balance:t})}else if("income"===S.type){let t=e.balance+parseFloat(S.amount);await c.cardsService.update(S.cardId,{balance:t})}}}x(),n(),T({type:u,amount:"",category:"",description:"",cardId:N[0]?.id||"",date:new Date().toISOString().split("T")[0]})}catch(e){console.error("Error adding transaction:",e),alert("Failed to add transaction. Please try again.")}finally{v(!1)}};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(g,{isOpen:j,onClose:()=>w(!1),onDataExtracted:e=>{T(t=>({...t,amount:e.amount.toString(),description:e.merchant,category:e.category||"Other",date:e.date||t.date})),w(!1)}}),(0,t.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/70 backdrop-blur-sm",children:(0,t.jsxs)("div",{className:"bg-slate-950 border border-amber-700/30 rounded-lg w-full max-w-sm sm:max-w-md",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between p-4 border-b border-slate-800",children:[(0,t.jsxs)("div",{className:"flex items-center gap-3",children:["income"===S.type?(0,t.jsx)(r.TrendingUp,{className:"h-6 w-6 text-green-400"}):(0,t.jsx)(l.TrendingDown,{className:"h-6 w-6 text-amber-400"}),(0,t.jsxs)("h2",{className:"text-2xl font-serif text-slate-100 tracking-wide",children:["Add ","income"===S.type?"Income":"Expense"]})]}),(0,t.jsxs)("div",{className:"flex items-center gap-2",children:["expense"===S.type&&(0,t.jsx)("button",{type:"button",onClick:()=>w(!0),className:"p-2 text-slate-400 hover:text-amber-400 transition-colors",title:"Scan Receipt",children:(0,t.jsx)(i,{className:"h-5 w-5"})}),(0,t.jsx)("button",{onClick:n,className:"text-slate-400 hover:text-slate-200 transition-colors",children:(0,t.jsx)(s.X,{className:"h-6 w-6"})})]})]}),(0,t.jsxs)("form",{onSubmit:E,className:"p-4 space-y-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-slate-400 text-xs tracking-widest uppercase mb-2 font-serif",children:"Transaction Type"}),(0,t.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,t.jsx)("button",{type:"button",onClick:()=>T({...S,type:"income",category:""}),className:`py-3 border transition-colors tracking-wider uppercase text-sm ${"income"===S.type?"border-green-600 text-green-400 bg-green-900/10":"border-slate-700 text-slate-400 hover:border-slate-600"}`,children:"Income"}),(0,t.jsx)("button",{type:"button",onClick:()=>T({...S,type:"expense",category:""}),className:`py-3 border transition-colors tracking-wider uppercase text-sm ${"expense"===S.type?"border-amber-600 text-amber-400 bg-amber-900/10":"border-slate-700 text-slate-400 hover:border-slate-600"}`,children:"Expense"})]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-slate-400 text-xs tracking-widest uppercase mb-2 font-serif",children:"Amount"}),(0,t.jsxs)("div",{className:"relative",children:[(0,t.jsx)("span",{className:"absolute left-4 top-1/2 -translate-y-1/2 text-slate-400",children:h.symbol}),(0,t.jsx)("input",{type:"number",step:"0.01",required:!0,value:S.amount,onChange:e=>T({...S,amount:e.target.value}),placeholder:"0.00",className:"w-full pl-8 pr-4 py-3 bg-slate-900/50 border border-slate-700 text-slate-100 rounded focus:border-amber-600 focus:outline-none transition-colors font-serif"})]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-slate-400 text-xs tracking-widest uppercase mb-2 font-serif",children:"Category"}),(0,t.jsxs)("select",{required:!0,value:S.category,onChange:e=>T({...S,category:e.target.value}),className:"w-full px-4 py-3 bg-slate-900/50 border border-slate-700 text-slate-100 rounded focus:border-amber-600 focus:outline-none transition-colors font-serif",children:[(0,t.jsx)("option",{value:"",children:"Select category"}),C[S.type].map(e=>(0,t.jsx)("option",{value:e,children:e},e))]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-slate-400 text-xs tracking-widest uppercase mb-2 font-serif",children:"Description"}),(0,t.jsx)("input",{type:"text",required:!0,value:S.description,onChange:e=>T({...S,description:e.target.value}),placeholder:"e.g., Grocery shopping",className:"w-full px-4 py-3 bg-slate-900/50 border border-slate-700 text-slate-100 rounded focus:border-amber-600 focus:outline-none transition-colors font-serif"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-slate-400 text-xs tracking-widest uppercase mb-2 font-serif",children:"Card/Account"}),(0,t.jsx)("select",{required:!0,value:S.cardId,onChange:e=>T({...S,cardId:e.target.value}),className:"w-full px-4 py-3 bg-slate-900/50 border border-slate-700 text-slate-100 rounded focus:border-amber-600 focus:outline-none transition-colors font-serif",children:0===N.length?(0,t.jsx)("option",{value:"",children:"No valid cards available (expired cards are hidden)"}):N.map(e=>(0,t.jsxs)("option",{value:e.id,children:[e.name||e.type," - ",e.type," (â€¢â€¢",e.lastFour||"****",")"]},e.id))})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-slate-400 text-xs tracking-widest uppercase mb-2 font-serif",children:"Date"}),(0,t.jsx)("input",{type:"date",required:!0,value:S.date,onChange:e=>T({...S,date:e.target.value}),className:"w-full px-4 py-3 bg-slate-900/50 border border-slate-700 text-slate-100 rounded focus:border-amber-600 focus:outline-none transition-colors font-serif"})]}),(0,t.jsxs)("div",{className:"flex gap-4 pt-4",children:[(0,t.jsx)("button",{type:"button",onClick:n,className:"flex-1 px-6 py-3 border border-slate-700 text-slate-400 hover:border-slate-600 hover:text-slate-200 transition-colors tracking-wider uppercase text-sm",children:"Cancel"}),(0,t.jsx)("button",{type:"submit",disabled:y||0===N.length,className:"flex-1 px-6 py-3 border border-amber-600 text-amber-400 hover:bg-amber-600/10 transition-colors tracking-wider uppercase text-sm disabled:opacity-50 disabled:cursor-not-allowed",children:y?"Adding...":0===N.length?"No Valid Cards":"Add Transaction"})]})]})]})})]})}e.s(["AddTransactionModal",()=>y],71589)},66775,53502,e=>{"use strict";let t;e.i(15525),e.i(64637);var a,s=e.i(60333);e.i(32234);var r=e.i(98466);e.i(75271);var l=e.i(5158);t=(0,s.getApps)().length?(0,s.getApp)():(0,s.initializeApp)({apiKey:"AIzaSyCbioszHdBJKCVzel9fy-iXa3k8uB6sS8I",authDomain:"chat-76d96.firebaseapp.com",projectId:"chat-76d96",storageBucket:"chat-76d96.firebasestorage.app",messagingSenderId:"950285925188",appId:"1:950285925188:web:ef7bf698a9571cafc5b511",measurementId:"G-BZZPT0RQNY"});let n=(0,r.getAuth)(t),i=(0,l.getFirestore)(t);e.s(["auth",0,n,"db",0,i],53502);var c=new Uint8Array(16);let o=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;for(var d=[],m=0;m<256;++m)d.push((m+256).toString(16).substr(1));let x=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,a=(d[e[t+0]]+d[e[t+1]]+d[e[t+2]]+d[e[t+3]]+"-"+d[e[t+4]]+d[e[t+5]]+"-"+d[e[t+6]]+d[e[t+7]]+"-"+d[e[t+8]]+d[e[t+9]]+"-"+d[e[t+10]]+d[e[t+11]]+d[e[t+12]]+d[e[t+13]]+d[e[t+14]]+d[e[t+15]]).toLowerCase();if(!("string"==typeof a&&o.test(a)))throw TypeError("Stringified UUID is invalid");return a},u=function(e,t,s){var r=(e=e||{}).random||(e.rng||function(){if(!a&&!(a="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto)))throw Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return a(c)})();if(r[6]=15&r[6]|64,r[8]=63&r[8]|128,t){s=s||0;for(var l=0;l<16;++l)t[s+l]=r[l];return t}return x(r)},p="savingsAccounts",h="transfers";e.s(["savingsAccountsService",0,{async createAccount(e){let t=u(),a=new Date,s={...e,id:t,createdAt:a,updatedAt:a};return await (0,l.setDoc)((0,l.doc)(i,p,t),s),s},async getAccount(e){let t=(0,l.doc)(i,p,e),a=await (0,l.getDoc)(t);return a.exists()?{id:a.id,...a.data(),createdAt:a.data().createdAt?.toDate(),updatedAt:a.data().updatedAt?.toDate()}:null},async getUserAccounts(e){let t=(0,l.query)((0,l.collection)(i,p),(0,l.where)("userId","==",e),(0,l.orderBy)("createdAt","desc"));return(await (0,l.getDocs)(t)).docs.map(e=>({id:e.id,...e.data(),createdAt:e.data().createdAt?.toDate(),updatedAt:e.data().updatedAt?.toDate()}))},async updateAccount(e,t){let a=(0,l.doc)(i,p,e);await (0,l.updateDoc)(a,{...t,updatedAt:new Date})},async deleteAccount(e){let t=(0,l.doc)(i,p,e);await (0,l.deleteDoc)(t)},async createTransfer(e){let t=(0,l.writeBatch)(i),a=u(),s=new Date,r={...e,id:a,status:"pending",createdAt:s,updatedAt:s};try{let n=(0,l.doc)(i,h,a);if(t.set(n,r),"card"===e.fromAccountType){let a=await (0,l.getDoc)((0,l.doc)(i,"cards",e.fromAccountId)),r=a.data()?.balance||0,n=(0,l.doc)(i,"cards",e.fromAccountId);t.update(n,{balance:r-e.amount,updatedAt:s})}else{let a=await (0,l.getDoc)((0,l.doc)(i,p,e.fromAccountId)),r=a.data()?.balance||0,n=(0,l.doc)(i,p,e.fromAccountId);t.update(n,{balance:r-e.amount,updatedAt:s})}if("card"===e.toAccountType){let a=await (0,l.getDoc)((0,l.doc)(i,"cards",e.toAccountId)),r=a.data()?.balance||0,n=(0,l.doc)(i,"cards",e.toAccountId);t.update(n,{balance:r+e.amount,updatedAt:s})}else{let a=await (0,l.getDoc)((0,l.doc)(i,p,e.toAccountId)),r=a.data()?.balance||0,n=(0,l.doc)(i,p,e.toAccountId);t.update(n,{balance:r+e.amount,updatedAt:s})}let c={userId:e.userId,amount:e.amount,type:"transfer",category:"Transfer",description:e.description||"Account Transfer",date:s,isRecurring:!1,transferId:a},o=(0,l.doc)((0,l.collection)(i,"transactions"));t.set(o,{...c,["card"===e.fromAccountType?"cardId":"savingsAccountId"]:e.fromAccountId,type:"withdrawal"});let d=(0,l.doc)((0,l.collection)(i,"transactions"));return t.set(d,{...c,["card"===e.toAccountType?"cardId":"savingsAccountId"]:e.toAccountId,type:"deposit"}),t.update(n,{status:"completed"}),await t.commit(),r}catch(t){console.error("Transfer failed:",t);let e=(0,l.doc)(i,h,a);throw await (0,l.updateDoc)(e,{status:"failed",updatedAt:new Date}),Error("Transfer failed. Please try again.")}},async getTransfers(e){let t=(0,l.query)((0,l.collection)(i,h),(0,l.where)("userId","==",e),(0,l.orderBy)("createdAt","desc"));return(await (0,l.getDocs)(t)).docs.map(e=>({id:e.id,...e.data(),createdAt:e.data().createdAt?.toDate(),updatedAt:e.data().updatedAt?.toDate()}))},async getTransfer(e){let t=(0,l.doc)(i,h,e),a=await (0,l.getDoc)(t);return a.exists()?{id:a.id,...a.data(),createdAt:a.data().createdAt?.toDate(),updatedAt:a.data().updatedAt?.toDate()}:null}}],66775)},43799,e=>{"use strict";e.i(15525);var t=e.i(52621),a=e.i(82078),s=e.i(2188),r=e.i(20976),l=e.i(38957),n=e.i(65131),i=e.i(73755),c=e.i(7233),o=e.i(44025);e.i(75271);var d=e.i(5158),m=e.i(41195),x=e.i(71589),u=e.i(37727),p=e.i(61659);function h({isOpen:e,onClose:a,cards:s,type:r}){let{formatAmount:n}=(0,l.useCurrency)();if(!e)return null;let i=s.filter(e=>e.type===r),c=i.reduce((e,t)=>e+t.balance,0),o="credit"===r?"Credit Cards":"Debit Cards";return(0,t.jsx)("div",{className:"fixed inset-0 z-50 bg-black/80 backdrop-blur-sm flex items-center justify-center p-4",onClick:a,children:(0,t.jsxs)("div",{className:"bg-slate-950 border border-amber-700/30 rounded-lg shadow-2xl max-w-2xl w-full max-h-[90vh] overflow-hidden",onClick:e=>e.stopPropagation(),children:[(0,t.jsxs)("div",{className:"flex items-center justify-between p-6 border-b border-slate-800",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h2",{className:"text-2xl font-serif text-slate-100 tracking-wide mb-1",children:o.toUpperCase()}),(0,t.jsxs)("p",{className:"text-slate-500 text-sm tracking-wider",children:[i.length," ",1===i.length?"Card":"Cards"," â€¢ Total: ",n(c)]})]}),(0,t.jsx)("button",{onClick:a,className:"text-slate-400 hover:text-slate-200 transition-colors",children:(0,t.jsx)(u.X,{className:"h-6 w-6"})})]}),(0,t.jsx)("div",{className:"p-6 space-y-4 overflow-y-auto max-h-[calc(90vh-140px)]",children:i.length>0?i.map(e=>(0,t.jsx)("div",{className:"bg-slate-900 border border-slate-800 rounded-lg p-6 hover:border-amber-600/50 transition-colors",children:(0,t.jsxs)("div",{className:"flex items-start justify-between",children:[(0,t.jsxs)("div",{className:"flex items-start gap-4",children:[(0,t.jsx)("div",{className:`p-3 rounded-lg ${"credit"===r?"bg-blue-900/20 text-blue-400":"bg-green-900/20 text-green-400"}`,children:(0,t.jsx)(p.CreditCard,{className:"h-6 w-6"})}),(0,t.jsxs)("div",{children:[(0,t.jsx)("h3",{className:"text-lg font-serif text-slate-100 mb-1",children:e.name||`${"credit"===r?"Credit":"Debit"} Card`}),(0,t.jsxs)("div",{className:"space-y-1",children:[e.cardHolder&&(0,t.jsx)("p",{className:"text-sm text-slate-400",children:e.cardHolder}),e.lastFour&&(0,t.jsxs)("p",{className:"text-sm text-slate-500 font-mono",children:["â€¢â€¢â€¢â€¢ ",e.lastFour]}),(0,t.jsx)("p",{className:"text-xs text-slate-600 uppercase tracking-wider",children:"credit"===r?"Available Credit":"Available Balance"})]})]})]}),(0,t.jsx)("div",{className:"text-right",children:(0,t.jsx)("div",{className:`text-2xl font-serif ${"credit"===r?"text-blue-400":"text-green-400"}`,children:n(e.balance)})})]})},e.id)):(0,t.jsxs)("div",{className:"text-center py-12",children:[(0,t.jsx)("div",{className:"w-16 h-16 bg-slate-800 rounded-full flex items-center justify-center mx-auto mb-4",children:(0,t.jsx)(p.CreditCard,{className:"h-8 w-8 text-slate-600"})}),(0,t.jsxs)("p",{className:"text-slate-400 font-serif",children:["No ",r," cards found"]}),(0,t.jsx)("p",{className:"text-slate-600 text-sm mt-2",children:"Add a card to get started"})]})}),(0,t.jsxs)("div",{className:"flex items-center justify-between p-6 border-t border-slate-800 bg-slate-900/50",children:[(0,t.jsxs)("div",{children:[(0,t.jsxs)("p",{className:"text-slate-500 text-xs uppercase tracking-wider mb-1",children:["Total ","credit"===r?"Available Credit":"Balance"]}),(0,t.jsx)("p",{className:"text-3xl font-serif text-slate-100",children:n(c)})]}),(0,t.jsx)("button",{onClick:a,className:"px-6 py-3 border border-amber-600 text-amber-400 hover:bg-amber-600/10 transition-colors font-serif tracking-wider uppercase text-sm",children:"Close"})]})]})})}var g=e.i(43553);let b=(0,e.i(75254).default)("arrow-right",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]]);function f({title:e="Upgrade to Unlock More",message:s="You've reached your plan limit. Upgrade to access more features.",feature:l,showCloseButton:n=!0,compact:i=!1,onClose:c}){let o=(0,r.useRouter)(),[d,m]=(0,a.useState)(!1),[x,p]=(0,a.useState)(!0);if(!x)return null;let h=async()=>{m(!0),o.push("/subscription")},f=()=>{p(!1),c?.()};return i?(0,t.jsx)("div",{className:"bg-linear-to-r from-amber-500/10 to-orange-500/10 border border-amber-500/20 rounded-lg p-3",children:(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)(g.Crown,{className:"h-4 w-4 text-amber-500"}),(0,t.jsx)("span",{className:"text-sm font-medium text-amber-700 dark:text-amber-300",children:l?`${l} limit reached`:e})]}),(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)("button",{onClick:h,disabled:d,className:"text-xs bg-amber-500 hover:bg-amber-600 text-white px-2 py-1 rounded font-medium transition-colors",children:d?"Loading...":"Upgrade"}),n&&(0,t.jsx)("button",{onClick:f,className:"text-amber-500 hover:text-amber-600 transition-colors",children:(0,t.jsx)(u.X,{className:"h-3 w-3"})})]})]})}):(0,t.jsxs)("div",{className:"bg-linear-to-br from-amber-50 to-orange-50 dark:from-amber-950/20 dark:to-orange-950/20 border border-amber-200 dark:border-amber-800/30 rounded-xl p-6 shadow-sm",children:[(0,t.jsxs)("div",{className:"flex items-start justify-between",children:[(0,t.jsxs)("div",{className:"flex items-start gap-4",children:[(0,t.jsx)("div",{className:"shrink-0",children:(0,t.jsx)("div",{className:"w-12 h-12 bg-linear-to-br from-amber-400 to-orange-500 rounded-full flex items-center justify-center",children:(0,t.jsx)(g.Crown,{className:"h-6 w-6 text-white"})})}),(0,t.jsxs)("div",{className:"flex-1",children:[(0,t.jsx)("h3",{className:"text-lg font-semibold text-amber-900 dark:text-amber-100 mb-2",children:e}),(0,t.jsxs)("p",{className:"text-amber-700 dark:text-amber-300 text-sm leading-relaxed",children:[s,l&&(0,t.jsxs)("span",{className:"font-medium",children:[" Upgrade to add more ",l.toLowerCase(),"."]})]})]})]}),n&&(0,t.jsx)("button",{onClick:f,className:"text-amber-400 hover:text-amber-600 dark:text-amber-500 dark:hover:text-amber-400 transition-colors",children:(0,t.jsx)(u.X,{className:"h-5 w-5"})})]}),(0,t.jsxs)("div",{className:"mt-6 flex gap-3",children:[(0,t.jsx)("button",{onClick:h,disabled:d,className:"flex items-center gap-2 bg-linear-to-r from-amber-500 to-orange-500 hover:from-amber-600 hover:to-orange-600 text-white px-4 py-2 rounded-lg font-medium transition-all duration-200 shadow-sm hover:shadow-md",children:d?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("div",{className:"w-4 h-4 border-2 border-white/30 border-t-white rounded-full animate-spin"}),"Upgrading..."]}):(0,t.jsxs)(t.Fragment,{children:["Upgrade Now",(0,t.jsx)(b,{className:"h-4 w-4"})]})}),(0,t.jsx)("button",{onClick:()=>o.push("/subscription"),className:"text-amber-700 dark:text-amber-300 hover:text-amber-900 dark:hover:text-amber-100 text-sm font-medium px-4 py-2 rounded-lg border border-amber-200 dark:border-amber-800/30 hover:border-amber-300 dark:hover:border-amber-700/50 transition-colors",children:"View Plans"})]})]})}var y=e.i(84099),v=e.i(66775);function j(){let{user:e}=(0,s.useAuth)(),{formatAmount:r}=(0,l.useCurrency)(),[n,i]=(0,a.useState)(null),[c,o]=(0,a.useState)(!0),x=(0,a.useCallback)(async()=>{if(e)try{o(!0);let t=(0,d.collection)(m.db,"transactions"),a=(0,d.query)(t,(0,d.where)("userId","==",e.uid)),s=(await (0,d.getDocs)(a)).docs.map(e=>({id:e.id,...e.data(),date:e.data().date?.toDate?.()||new Date(e.data().date)})),r=s.filter(e=>"expense"===e.type).reduce((e,t)=>e+(t.amount||0),0),l=s.filter(e=>"income"===e.type).reduce((e,t)=>e+(t.amount||0),0),n=s.length>0?s.reduce((e,t)=>e+(t.amount||0),0)/s.length:0,c={};s.forEach(e=>{e.category&&(c[e.category]=(c[e.category]||0)+(e.amount||0))});let x=Object.entries(c).sort(([,e],[,t])=>t-e).slice(0,5).map(([e,t])=>({category:e,amount:t,percentage:r>0?t/r*100:0})),u={},p=Array.from({length:6},(e,t)=>{let a=new Date;return a.setMonth(a.getMonth()-t),a.toISOString().slice(0,7)}).reverse();p.forEach(e=>{u[e]={spent:0,earned:0}}),s.forEach(e=>{let t=e.date.toISOString().slice(0,7);u[t]&&("expense"===e.type?u[t].spent+=e.amount||0:"income"===e.type&&(u[t].earned+=e.amount||0))});let h=p.map(e=>({month:new Date(e+"-01").toLocaleDateString("en-US",{month:"short"}),spent:u[e].spent,earned:u[e].earned}));i({totalSpent:r,totalEarned:l,netIncome:l-r,topCategories:x,monthlyTrend:h,averageTransaction:n})}catch(e){console.error("Error loading analytics:",e)}finally{o(!1)}},[e]);return((0,a.useEffect)(()=>{e&&x()},[x,e]),c)?(0,t.jsx)("div",{className:"bg-slate-900/50 border border-slate-800 rounded-lg p-6",children:(0,t.jsx)("div",{className:"flex items-center justify-center h-32",children:(0,t.jsx)("div",{className:"text-amber-400 text-sm font-serif tracking-wider",children:"Loading analytics..."})})}):n?(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsxs)("div",{className:"flex items-center gap-4 mb-6",children:[(0,t.jsx)("div",{className:"w-12 h-0.5 bg-linear-to-r from-amber-600 to-transparent"}),(0,t.jsx)("h2",{className:"text-2xl font-serif text-slate-100 tracking-wide",children:"Financial Insights"})]}),(0,t.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[(0,t.jsxs)("div",{className:"bg-slate-900/50 border border-slate-800 rounded-lg p-4",children:[(0,t.jsx)("div",{className:"text-slate-500 text-xs tracking-widest uppercase mb-2",children:"Total Spent"}),(0,t.jsx)("div",{className:"text-xl font-bold text-red-400",children:r(n.totalSpent)})]}),(0,t.jsxs)("div",{className:"bg-slate-900/50 border border-slate-800 rounded-lg p-4",children:[(0,t.jsx)("div",{className:"text-slate-500 text-xs tracking-widest uppercase mb-2",children:"Total Earned"}),(0,t.jsx)("div",{className:"text-xl font-bold text-green-400",children:r(n.totalEarned)})]}),(0,t.jsxs)("div",{className:"bg-slate-900/50 border border-slate-800 rounded-lg p-4",children:[(0,t.jsx)("div",{className:"text-slate-500 text-xs tracking-widest uppercase mb-2",children:"Net Income"}),(0,t.jsx)("div",{className:`text-xl font-bold ${n.netIncome>=0?"text-green-400":"text-red-400"}`,children:r(n.netIncome)})]}),(0,t.jsxs)("div",{className:"bg-slate-900/50 border border-slate-800 rounded-lg p-4",children:[(0,t.jsx)("div",{className:"text-slate-500 text-xs tracking-widest uppercase mb-2",children:"Avg Transaction"}),(0,t.jsx)("div",{className:"text-xl font-bold text-amber-400",children:r(n.averageTransaction)})]})]}),(0,t.jsxs)("div",{className:"bg-slate-900/50 border border-slate-800 rounded-lg p-4 sm:p-6",children:[(0,t.jsx)("h3",{className:"text-lg font-serif text-slate-100 mb-4",children:"Top Spending Categories"}),(0,t.jsx)("div",{className:"space-y-3",children:n.topCategories.length>0?n.topCategories.map((e,a)=>(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsx)("div",{className:"w-8 h-8 bg-amber-600/20 rounded-full flex items-center justify-center text-sm font-bold text-amber-400",children:a+1}),(0,t.jsx)("span",{className:"text-slate-300",children:e.category})]}),(0,t.jsxs)("div",{className:"text-right",children:[(0,t.jsx)("div",{className:"text-slate-100 font-medium",children:r(e.amount)}),(0,t.jsxs)("div",{className:"text-xs text-slate-500",children:[e.percentage.toFixed(1),"%"]})]})]},e.category)):(0,t.jsx)("div",{className:"text-center text-slate-500 py-4",children:"No spending data available yet"})})]}),(0,t.jsxs)("div",{className:"bg-slate-900/50 border border-slate-800 rounded-lg p-4 sm:p-6",children:[(0,t.jsx)("h3",{className:"text-lg font-serif text-slate-100 mb-4",children:"Monthly Trend"}),(0,t.jsx)("div",{className:"grid grid-cols-3 sm:grid-cols-6 gap-2 sm:gap-4",children:n.monthlyTrend.map(e=>(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)("div",{className:"text-xs sm:text-xs text-slate-500 mb-1",children:e.month}),(0,t.jsxs)("div",{className:"space-y-1",children:[(0,t.jsxs)("div",{className:"text-[10px] sm:text-xs text-green-400 font-medium",children:["+",r(e.earned)]}),(0,t.jsxs)("div",{className:"text-[10px] sm:text-xs text-red-400 font-medium",children:["-",r(e.spent)]})]})]},e.month))})]})]}):null}function w(){let{user:e}=(0,s.useAuth)(),u=(0,r.useRouter)(),{formatAmount:p}=(0,l.useCurrency)(),{tier:g,subscription:b}=(0,n.useSubscription)(),{canAddCard:y,canAddTransaction:w}=(0,i.useAccessControl)(),[N,k]=(0,a.useState)([]),[C,A]=(0,a.useState)([]),[S,T]=(0,a.useState)([]),[I,D]=(0,a.useState)(!0),[E,U]=(0,a.useState)(!1),[R,F]=(0,a.useState)(!1),[P,O]=(0,a.useState)(!1),[B,L]=(0,a.useState)("credit"),[z,M]=(0,a.useState)({cards:!1,transactions:!1}),[$,q]=(0,a.useState)(0),H=C.length>0,[G,V]=(0,a.useState)({totalBalance:0,creditBalance:0,debitBalance:0,creditCardCount:0,debitCardCount:0,income:0,expenses:0,savings:0}),Y=(0,a.useCallback)(async()=>{if(e){if(e.email&&("spendflowapp@gmail.com".split(",")||[]).includes(e.email))return void M({cards:!1,transactions:!1});try{let e=await y(),t=await w();M({cards:!e.allowed,transactions:!t.allowed})}catch(e){console.error("Error checking subscription limits:",e)}}},[e,y,w]),X=(0,a.useCallback)(async()=>{if(e)try{let t=(0,d.query)((0,d.collection)(m.db,"transactions"),(0,d.where)("userId","==",e.uid)),a=(await (0,d.getDocs)(t)).docs.map(e=>({id:e.id,...e.data()}));k(a.slice(0,3));let s=a.filter(e=>"income"===e.type).reduce((e,t)=>e+t.amount,0),r=a.filter(e=>"expense"===e.type).reduce((e,t)=>e+t.amount,0),l=(0,d.query)((0,d.collection)(m.db,"cards"),(0,d.where)("userId","==",e.uid)),n=(await (0,d.getDocs)(l)).docs.map(e=>({id:e.id,...e.data()}));A(n);let i=n.filter(e=>"credit"===e.type),c=n.filter(e=>"debit"===e.type),o=i.reduce((e,t)=>e+t.balance,0),x=c.reduce((e,t)=>e+t.balance,0),u=await v.savingsAccountsService.getUserAccounts(e.uid);T(u);let p=u.reduce((e,t)=>e+t.balance,0);V({totalBalance:x+o,creditBalance:o,debitBalance:x,creditCardCount:i.length,debitCardCount:c.length,income:s,expenses:r,savings:p}),await Y()}catch(e){console.error("Error fetching data:",e)}finally{D(!1)}},[e,Y]);if((0,a.useEffect)(()=>{e&&X()},[e,X]),I)return(0,t.jsx)("div",{className:"flex items-center justify-center h-screen",children:(0,t.jsx)("div",{className:"text-amber-400 text-lg font-serif tracking-wider",children:"Loading..."})});let K=async()=>{if(!H){F(!0),setTimeout(()=>{u.push("/cards")},2e3);return}(await w()).allowed&&U(!0)};return(0,t.jsxs)("div",{className:"space-y-12",children:[(0,t.jsx)(x.AddTransactionModal,{isOpen:E,onClose:()=>U(!1),onSuccess:()=>{X(),q(e=>e+1)}}),(0,t.jsx)(h,{isOpen:P,onClose:()=>O(!1),cards:C,type:B}),R&&(0,t.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/80 backdrop-blur-sm",children:(0,t.jsxs)("div",{className:"bg-slate-900 border border-amber-700/30 rounded-lg p-8 max-w-md mx-4 text-center",children:[(0,t.jsxs)("div",{className:"mb-6",children:[(0,t.jsx)("div",{className:"w-16 h-16 bg-amber-600/20 rounded-full flex items-center justify-center mx-auto mb-4",children:(0,t.jsx)(c.Plus,{className:"h-8 w-8 text-amber-400"})}),(0,t.jsx)("h3",{className:"text-2xl font-serif text-slate-100 mb-2 tracking-wide",children:"No Cards Found"}),(0,t.jsx)("p",{className:"text-slate-400 text-sm",children:"You need to add a payment card before creating transactions."})]}),(0,t.jsxs)("div",{className:"flex items-center justify-center gap-2 text-amber-400",children:[(0,t.jsx)("div",{className:"animate-spin rounded-full h-5 w-5 border-2 border-amber-400 border-t-transparent"}),(0,t.jsx)("span",{className:"text-sm tracking-wider",children:"Redirecting to Cards page..."})]})]})}),(0,t.jsxs)("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h1",{className:"text-2xl sm:text-3xl md:text-4xl lg:text-5xl font-serif text-slate-100 mb-2 tracking-wide",children:"D A S H B O A R D"}),(0,t.jsx)("p",{className:"text-slate-400 text-sm tracking-widest uppercase",children:"Financial Overview"})]}),(0,t.jsxs)("button",{onClick:K,className:"flex items-center gap-2 px-4 sm:px-6 py-2 sm:py-3 border border-(--theme-accent) text-(--theme-accent) hover:bg-(--theme-accent)/10 transition-colors tracking-wider uppercase text-sm w-full sm:w-auto justify-center",children:[(0,t.jsx)(c.Plus,{className:"h-4 w-4 sm:h-5 sm:w-5"}),(0,t.jsx)("span",{className:"hidden xs:inline",children:"Add Transaction"}),(0,t.jsx)("span",{className:"xs:hidden",children:"Add"})]})]}),(0,t.jsx)("div",{className:"mb-8",children:(0,t.jsxs)("div",{className:"flex items-center justify-between p-4 border border-slate-800 bg-slate-900/30 backdrop-blur-sm rounded-lg",children:[(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsx)("div",{className:"w-10 h-10 bg-linear-to-br from-amber-400 to-orange-500 rounded-full flex items-center justify-center",children:(0,t.jsx)(o.Award,{className:"h-5 w-5 text-white"})}),(0,t.jsxs)("div",{children:[(0,t.jsxs)("div",{className:"text-slate-100 font-medium",children:[e?.email&&("spendflowapp@gmail.com".split(",")||[]).includes(e.email)?"Administrator":"free"===g?"Essential":"pro"===g?"Professional":"Enterprise"," Plan"]}),(0,t.jsx)("div",{className:"text-slate-400 text-sm",children:e?.email&&("spendflowapp@gmail.com".split(",")||[]).includes(e.email)?"Unlimited access to all features":b?.currentPeriodEnd?`Renews ${b.currentPeriodEnd.toLocaleDateString()}`:"Free plan"})]})]}),(0,t.jsx)("button",{onClick:()=>u.push("/subscription"),className:`px-4 py-2 font-medium rounded-lg transition-colors text-sm ${e?.email&&("spendflowapp@gmail.com".split(",")||[]).includes(e.email)?"bg-purple-600 hover:bg-purple-700 text-white":"enterprise"===g?"bg-slate-600 hover:bg-slate-700 text-white":"bg-amber-500 hover:bg-amber-600 text-slate-900"}`,children:e?.email&&("spendflowapp@gmail.com".split(",")||[]).includes(e.email)?"Admin Panel":"enterprise"===g?"Manage Plan":"Upgrade"})]})}),(z.cards||z.transactions)&&(0,t.jsxs)("div",{className:"mb-8 space-y-4",children:[z.cards&&(0,t.jsx)(f,{title:"Card Limit Reached",message:"You've reached your card limit. Upgrade to add more cards to your account.",feature:"cards"}),z.transactions&&(0,t.jsx)(f,{title:"Transaction Limit Reached",message:"You've reached your transaction limit. Upgrade to add unlimited transactions.",feature:"transactions"})]}),(0,t.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4 sm:gap-8 mb-12",children:[(0,t.jsx)("button",{onClick:()=>{L("credit"),O(!0)},className:"border border-slate-800 bg-slate-900/50 p-4 sm:p-8 backdrop-blur-sm hover:border-blue-600/50 transition-colors text-left",children:(0,t.jsxs)("div",{className:"border-l-2 border-(--theme-accent) pl-4 sm:pl-6",children:[(0,t.jsx)("div",{className:"text-slate-500 text-xs tracking-widest uppercase mb-2 sm:mb-3 font-serif",children:"Credit Cards"}),(0,t.jsx)("div",{className:"text-2xl sm:text-3xl lg:text-4xl font-serif text-slate-100 mb-2 break-all overflow-hidden text-ellipsis max-w-full",children:p(G.creditBalance)}),(0,t.jsxs)("div",{className:"text-slate-600 text-sm",children:[G.creditCardCount," ",1===G.creditCardCount?"Card":"Cards"]})]})}),(0,t.jsx)("button",{onClick:()=>{L("debit"),O(!0)},className:"border border-slate-800 bg-slate-900/50 p-4 sm:p-8 backdrop-blur-sm hover:border-green-600/50 transition-colors text-left",children:(0,t.jsxs)("div",{className:"border-l-2 border-(--theme-accent) pl-4 sm:pl-6",children:[(0,t.jsx)("div",{className:"text-slate-500 text-xs tracking-widest uppercase mb-2 sm:mb-3 font-serif",children:"Debit Cards"}),(0,t.jsx)("div",{className:"text-2xl sm:text-3xl lg:text-4xl font-serif text-slate-100 mb-2 break-all overflow-hidden text-ellipsis max-w-full",children:p(G.debitBalance)}),(0,t.jsxs)("div",{className:"text-slate-600 text-sm",children:[G.debitCardCount," ",1===G.debitCardCount?"Card":"Cards"]})]})})]}),(0,t.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4 sm:gap-8 mb-12",children:[(0,t.jsx)("button",{onClick:()=>u.push("/income"),className:"border border-slate-800 bg-slate-900/50 p-4 sm:p-8 backdrop-blur-sm hover:border-green-600/50 transition-colors text-left",children:(0,t.jsxs)("div",{className:"border-l-2 border-green-600 pl-4 sm:pl-6",children:[(0,t.jsx)("div",{className:"text-slate-500 text-xs tracking-widest uppercase mb-2 sm:mb-3 font-serif",children:"Income"}),(0,t.jsx)("div",{className:"text-2xl sm:text-3xl lg:text-4xl font-serif text-slate-100 mb-2 break-all overflow-hidden text-ellipsis max-w-full",children:p(G.income)}),(0,t.jsx)("div",{className:"text-slate-600 text-sm",children:"Total Revenue"})]})}),(0,t.jsx)("button",{onClick:()=>u.push("/expenses"),className:"border border-slate-800 bg-slate-900/50 p-4 sm:p-8 backdrop-blur-sm hover:border-red-600/50 transition-colors text-left",children:(0,t.jsxs)("div",{className:"border-l-2 border-red-600 pl-4 sm:pl-6",children:[(0,t.jsx)("div",{className:"text-slate-500 text-xs tracking-widest uppercase mb-2 sm:mb-3 font-serif",children:"Expenses"}),(0,t.jsx)("div",{className:"text-2xl sm:text-3xl lg:text-4xl font-serif text-slate-100 mb-2 break-all overflow-hidden text-ellipsis max-w-full",children:p(G.expenses)}),(0,t.jsx)("div",{className:"text-slate-600 text-sm",children:"Total Expenditure"})]})})]}),(0,t.jsxs)("div",{className:"mb-12",children:[(0,t.jsxs)("div",{className:"flex items-center gap-4 mb-8",children:[(0,t.jsx)("div",{className:"w-12 h-0.5 bg-linear-to-r from-(--theme-accent) to-transparent"}),(0,t.jsx)("h2",{className:"text-2xl font-serif text-slate-100 tracking-wide",children:"Portfolio Overview"})]}),(0,t.jsx)("div",{className:"border border-slate-800 bg-slate-900/30 backdrop-blur-sm",children:(0,t.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-3 divide-x divide-slate-800",children:[(0,t.jsxs)("button",{onClick:()=>u.push("/cards"),className:"p-4 sm:p-8 text-center hover:bg-slate-900/50 transition-colors",children:[(0,t.jsx)("div",{className:"text-(--theme-accent) mb-2 sm:mb-3",children:(0,t.jsx)(o.Award,{className:"h-6 w-6 sm:h-8 sm:w-8 mx-auto"})}),(0,t.jsx)("div",{className:"text-2xl sm:text-3xl font-serif text-slate-100 mb-2",children:C.length}),(0,t.jsx)("div",{className:"text-slate-500 text-xs tracking-widest uppercase",children:"Accounts"})]}),(0,t.jsxs)("button",{onClick:()=>u.push("/savings"),className:"p-4 sm:p-8 text-center hover:bg-slate-900/50 transition-colors",children:[(0,t.jsx)("div",{className:"text-(--theme-accent) mb-2 sm:mb-3",children:(0,t.jsx)("div",{className:"text-xl sm:text-3xl",children:"â—†"})}),(0,t.jsx)("div",{className:"text-xl sm:text-2xl lg:text-3xl font-serif text-slate-100 mb-2 break-all overflow-hidden text-ellipsis max-w-full",children:p(G.savings)}),(0,t.jsxs)("div",{className:"text-slate-500 text-xs tracking-widest uppercase",children:[S.length," ",1===S.length?"Account":"Accounts"]})]}),(0,t.jsxs)("button",{onClick:()=>u.push("/transactions"),className:"p-4 sm:p-8 text-center hover:bg-slate-900/50 transition-colors",children:[(0,t.jsx)("div",{className:"text-(--theme-accent) mb-2 sm:mb-3",children:(0,t.jsx)("div",{className:"text-xl sm:text-3xl",children:"â˜…"})}),(0,t.jsx)("div",{className:"text-2xl sm:text-3xl font-serif text-slate-100 mb-2",children:N.length}),(0,t.jsx)("div",{className:"text-slate-500 text-xs tracking-widest uppercase",children:"Transactions"})]})]})})]}),(0,t.jsxs)("div",{className:"mb-12",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between mb-8",children:[(0,t.jsxs)("div",{className:"flex items-center gap-4",children:[(0,t.jsx)("div",{className:"w-12 h-0.5 bg-linear-to-r from-(--theme-accent) to-transparent"}),(0,t.jsx)("h2",{className:"text-2xl font-serif text-slate-100 tracking-wide",children:"Recent Activity"})]}),(0,t.jsx)("button",{onClick:()=>u.push("/transactions"),className:"text-sm text-(--theme-accent) hover:text-(--theme-accent)/80 tracking-wider uppercase",children:"View All â†’"})]}),(0,t.jsx)("div",{className:"space-y-1",children:N.length>0?N.map(e=>(0,t.jsx)("div",{className:"border-b border-slate-800 py-6 hover:bg-slate-900/30 transition-colors",children:(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{className:"flex items-center gap-6",children:[(0,t.jsx)("div",{className:`w-1 h-12 ${"income"===e.type?"bg-green-600":"bg-(--theme-accent)"}`}),(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{className:"text-slate-200 font-serif mb-1",children:e.description}),(0,t.jsx)("div",{className:"text-slate-600 text-xs tracking-wider uppercase",children:e.category})]})]}),(0,t.jsxs)("div",{className:`font-serif text-lg sm:text-xl ${"income"===e.type?"text-green-400":"text-slate-300"} break-all max-w-full`,children:["income"===e.type?"+":"-",p(e.amount)]})]})},e.id)):(0,t.jsx)("div",{className:"text-center py-12 text-slate-500 font-serif",children:"No recent transactions"})})]}),(0,t.jsx)("div",{className:"mb-12",children:(0,t.jsx)(j,{},$)}),(0,t.jsxs)("div",{className:"text-center py-12 border-t border-slate-800",children:[(0,t.jsx)("div",{className:"text-(--theme-accent)/40 text-6xl mb-4",children:"â€œ"}),(0,t.jsx)("p",{className:"text-slate-400 text-lg font-serif italic mb-4 max-w-2xl mx-auto",children:"Wealth consists not in having great possessions, but in having few wants."}),(0,t.jsx)("div",{className:"text-slate-600 text-sm tracking-widest",children:"â€” EPICTETUS"})]})]})}function N(){return(0,t.jsx)(y.AuthGate,{children:(0,t.jsx)(w,{})})}e.s(["default",()=>N],43799)},76860,e=>{e.v(e=>Promise.resolve().then(()=>e(30945)))},94307,e=>{e.v(t=>Promise.all(["static/chunks/1e15f79587615e6b.js"].map(t=>e.l(t))).then(()=>t(46074)))}]);