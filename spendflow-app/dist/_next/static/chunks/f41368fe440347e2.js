(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,84614,e=>{"use strict";let s=(0,e.i(75254).default)("user",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]);e.s(["User",()=>s],84614)},25308,e=>{"use strict";e.i(11781);var s=e.i(50347),r=e.i(41195);e.s(["monitorAllUsersStatus",0,(e,l)=>{console.log("ğŸ‘€ [Presence] Setting up status monitor for all users");try{let t=(0,s.ref)(r.rtdb,"status"),n=(0,s.onChildAdded)(t,s=>{let r=s.key,l=s.val();console.log(`â• [Presence] New user status detected - ${r}:`,l),r&&l&&e(r,l)},e=>{console.error("âŒ [Presence] Error in onChildAdded:",e),l?.(e)}),i=(0,s.onChildChanged)(t,s=>{let r=s.key,l=s.val();console.log(`ğŸ”„ [Presence] Status changed - ${r}:`,l),r&&l&&e(r,l)},e=>{console.error("âŒ [Presence] Error in onChildChanged:",e),l?.(e)}),o=(0,s.onChildRemoved)(t,s=>{let r=s.key;console.log(`â– [Presence] User removed - ${r}`),r&&e(r,{state:"offline",last_changed:Date.now()})},e=>{console.error("âŒ [Presence] Error in onChildRemoved:",e),l?.(e)});return console.log("âœ… [Presence] All status monitors set up"),()=>{console.log("ğŸ§¹ [Presence] Cleaning up status monitor");try{n(),i(),o()}catch(e){console.error("âŒ [Presence] Error during monitor cleanup:",e)}}}catch(e){return console.error("âŒ [Presence] Error setting up status monitor:",e),l?.(e),()=>{}}}])},96144,e=>{"use strict";var s=e.i(52621),r=e.i(82078),l=e.i(25308),t=e.i(30945),n=e.i(84614),i=e.i(61911);let o=(0,e.i(75254).default)("circle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]]);e.s(["OnlineUsers",0,()=>{let[e,a]=(0,r.useState)([]),[c,d]=(0,r.useState)(!0),[u,m]=(0,r.useState)({});(0,r.useEffect)(()=>{(async()=>{try{console.log("ğŸ‘¥ [OnlineUsers] Loading user profiles...");let e=await t.usersService.getAll(),s={};e.forEach(e=>{s[e.uid]=e}),m(s),console.log("âœ… [OnlineUsers] Loaded user profiles:",Object.keys(s).length,"users")}catch(e){console.error("âŒ [OnlineUsers] Error loading user profiles:",e),m({}),d(!1)}})()},[]),(0,r.useEffect)(()=>{let e=(async()=>{if(0===Object.keys(u).length)return console.log("ğŸ‘¥ [OnlineUsers] Waiting for user profiles before setting up presence..."),()=>{};console.log("ğŸ‘¥ [OnlineUsers] User profiles loaded, setting up presence monitoring...");let e=(()=>{try{let e=(0,l.monitorAllUsersStatus)((e,s)=>{let r="online"===s.state&&Date.now()-s.last_changed<18e5;console.log(`ğŸ‘¥ [OnlineUsers] RTDB Status update - User ${e}:`,s.state,`(time diff: ${(Date.now()-s.last_changed)/1e3}s)`,`online: ${r}`),a(s=>{let l=s.findIndex(s=>s.uid===e),t=u[e];if(!(l>=0))return[...s,{uid:e,email:t?.email,displayName:t?.displayName,online:r}];{let n=[...s];return n[l]={uid:e,email:t?.email,displayName:t?.displayName,online:r},n}})},e=>{console.warn("âš ï¸ [OnlineUsers] RTDB presence failed, falling back to empty list:",e),a([])});return console.log("âœ… [OnlineUsers] RTDB presence monitoring active"),e}catch(e){return console.warn("âš ï¸ [OnlineUsers] RTDB not available, showing no online users:",e),a([]),()=>{}}})();return d(!1),e})();return()=>{e.then(e=>{e()})}},[u]);let h=e.filter(e=>e.online).length;return c?(0,s.jsx)("div",{className:"flex items-center justify-center p-8",children:(0,s.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-2 border-amber-400 border-t-transparent"})}):(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{className:"flex items-center space-x-2 mb-4",children:[(0,s.jsx)(i.Users,{className:"h-5 w-5 text-amber-400"}),(0,s.jsxs)("h3",{className:"text-lg font-medium",children:["Online Users (",h,")"]})]}),(0,s.jsx)("div",{className:"space-y-2",children:0===e.filter(e=>e.online).length?(0,s.jsx)("p",{className:"text-slate-400 text-sm",children:"No users currently online"}):e.filter(e=>e.online).map(e=>(0,s.jsxs)("div",{className:"flex items-center justify-between p-3 bg-slate-800/50 rounded-lg hover:bg-slate-800 transition-colors",children:[(0,s.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,s.jsxs)("div",{className:"relative",children:[(0,s.jsx)("div",{className:"w-10 h-10 rounded-full bg-slate-700 flex items-center justify-center",children:(0,s.jsx)(n.User,{className:"h-5 w-5 text-slate-300"})}),(0,s.jsx)("div",{className:"absolute bottom-0 right-0 w-3 h-3 rounded-full border-2 border-slate-900 bg-green-500"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"font-medium text-slate-100",children:e.displayName||e.email||"Unknown User"}),(0,s.jsx)("p",{className:"text-xs text-slate-400",children:"Online now"})]})]}),(0,s.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,s.jsx)(o,{className:"h-2 w-2 text-green-500"}),(0,s.jsx)("span",{className:"text-xs text-slate-400",children:"Active"})]})]},e.uid))})]})}],96144)},55700,e=>{e.n(e.i(96144))}]);